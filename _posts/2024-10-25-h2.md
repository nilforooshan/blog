---
layout: post
title: "What does heritability do in BLUP?"
date: 2024-10-25
Categories: QuantitativeGenetics
permalink: /:title
---

Heritability (h<sup>2</sup>) has biological and statistical definitions.
Statistically, heritability is the proportion of the phenotypic variation explained by the genetic variation in the population.
Let's start with an example!
I took example 3.1 from [Mrode (2005)](https://www.cabidigitallibrary.org/doi/book/10.1079/9780851990002.0000).
This example is about estimating fixed effects (sex) solutions and predicting breeding values of animals for pre-weaning gain (WWG) of beef calves.
The data is presented in the following table:

|Calf|Sex|Sire|Dam|WWG (kg)|
|:--:|:---|:--:|:--:|:--:|
|4|Male|1|Unknown|4.5|
|5|Female|3|2|2.9|
|6|Female|1|2|3.9|
|7|Male|4|5|3.5|
|8|Male|3|6|5.0|

In an Animal Model BLUP, the inverse of the relationship matrix (**A**<sup>-1</sup>) is multiplied by &lambda; = (1 - h<sup>2</sup>)/h<sup>2</sup> (equal to (4 - h<sup>2</sup>)/h<sup>2</sup> in a Sire Model BLUP).
Considering h<sup>2</sup> = 1/3 (&lambda; = 2), the following solutions are obtained from BLUP:

<!--
library(ggroups)

h2 = 1/3
(ped = data.frame(ID = 1:8, SIRE = c(0,0,0,1,3,1,4,3), DAM = c(0,0,0,0,2,2,5,6)))
(Ainv = tab2mat(tabAinv(ped, inbreed(ped))))
(X = matrix(c(1,0,0,1,1,0,1,1,0,0), nrow = 5))
(Z = cbind(matrix(0, nrow = 5, ncol = 3), diag(5)))
(y = c(4.5, 2.9, 3.9, 3.5, 5.0))
C11 = crossprod(X)
C12 = crossprod(X, Z)
C22 = crossprod(Z) + Ainv * (1 - h2)/h2
LHS = rbind(cbind(C11, C12), cbind(t(C12), C22))
RHS = crossprod(cbind(X, Z), y)
(sols = round(solve(LHS, RHS), 3))
sort(sols[-2:-1,])
-->

|Effects|Solutions|
|:--:|---:|
|_Sex_||
|Male|4.359|
|Female|3.404|
|_Animal_||
|1|0.098|
|2|-0.019|
|3|-0.041|
|4|-0.009|
|5|-0.186|
|6|0.177|
|7|-0.249|
|8|0.183|

With h<sup>2</sup> = 0.5 (&lambda; = 1), the solutions change to:

<!--
h2 = 0.5
C22 = crossprod(Z) + Ainv * (1 - h2)/h2
LHS = rbind(cbind(C11, C12), cbind(t(C12), C22))
(sols = round(solve(LHS, RHS), 3))
sort(sols[-2:-1,])
-->

|Effects|Solutions|
|:--:|---:|
|_Sex_||
|male|4.373|
|female|3.412|
|_Animal_||
|1|0.148|
|2|-0.034|
|3|-0.060|
|4|-0.007|
|5|-0.283|
|6|0.260|
|7|-0.388|
|8|0.275|

The ranking of animals did not change.
However, the range of breeding values changed from -0.249&ndash;0.183 to -0.388&ndash;0.275.

BLUP regresses the estimated breeding values based on phenotype and relationship information toward the mean of the founder population (0).
Let's consider h<sup>2</sup> = 0.001.
The solutions change to:

|Effects|Solutions|
|:--:|---:|
|_Sex_||
|male|4.333|
|female|3.400|
|_Animal_||
|1|0.000|
|2|0.000|
|3|0.000|
|4|0.000|
|5|-0.001|
|6|0.001|
|7|-0.001|
|8|0.001|

The range of breeding values becomes -0.001 to 0.001.
The genetic variance got close to 0, and the breeding values heavily regressed toward 0.
On the other hand, as the heritability gets closer to 1, the genetic variance gets closer to the phenotypic variance.
Let's consider h2 = 0.999.
The solutions change to:

|Effects|Solutions|
|:--:|---:|
|_Sex_||
|male|4.443|
|female|3.491|
|_Animal_||
|1|0.281|
|2|-0.140|
|3|-0.085|
|4|0.056|
|5|-0.591|
|6|0.409|
|7|-0.942|
|8|0.556|

Calculating \\(\mathbf y - \mathbf X \hat{\mathbf b}\\) = {0.057, -0.591, 0.409, -0.943, 0.557}, we realise it is very close to the estimated breeding values of the phenotyped animals (animals 4&ndash;9).

