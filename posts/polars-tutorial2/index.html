<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Polars Tutorial2 | Mohammad Ali Nilforooshan</title>
<meta name="keywords" content="python">
<meta name="description" content="Most of these commands are derived with the help of ChatGPT or stackoverflow.
However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.
There might be a few Python examples here not directly related to Polars!
Read . as missing value
import polars as pl
# df = pl.read_csv(&#34;your_file.csv&#34;, null_values=&#34;.&#34;, has_header = True)
Replace . with missing value
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;.&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;.&#34;],
    &#34;col2&#34;: [10, 20, 30, 40],
    &#34;col3&#34;: [1, 2, 3, 4]
})

df = df.with_columns(pl.col(pl.String).replace({&#34;.&#34;: None}))

print(df)
shape: (4, 3)
┌───────┬──────┬──────┐
│ col1  ┆ col2 ┆ col3 │
│ ---   ┆ ---  ┆ ---  │
│ str   ┆ i64  ┆ i64  │
╞═══════╪══════╪══════╡
│ null  ┆ 10   ┆ 1    │
│ AB456 ┆ 20   ┆ 2    │
│ GK789 ┆ 30   ┆ 3    │
│ null  ┆ 40   ┆ 4    │
└───────┴──────┴──────┘
Get column names
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40],
    &#34;col3&#34;: [1, 2, 3, 4]
})

print(df.columns)

# Get the last two columns
print(df.columns[-2:])

# Get the first two columns
print(df.columns[:2])
[&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;]
[&#39;col2&#39;, &#39;col3&#39;]
[&#39;col1&#39;, &#39;col2&#39;]
Change values in a column based on a condition in another column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

# Replace values in &#39;col2&#39; based on the condition that &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(999)  # Replace with your desired value
    .otherwise(pl.col(&#34;col2&#34;))  # Keep original value if condition is not met
    .alias(&#34;col2&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 999  │
│ AB456 ┆ 20   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
Change values in a column based on multiple conditions in another column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 25, 30, 40]
})

# Replace values in &#39;col2&#39; based on multiple conditions
df = df.with_columns(
    pl.when((pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) &amp; (pl.col(&#34;col2&#34;) &gt; 20))
    .then(999)  # Replace with your desired value
    .otherwise(pl.col(&#34;col2&#34;))  # Keep original value if conditions are not met
    .alias(&#34;col2&#34;)
)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 25, 30, 40]
})

df = df.with_columns(
    pl.when(pl.col(&#34;col2&#34;) &lt; 11).then(20)
    .when(pl.col(&#34;col2&#34;) &gt; 33).then(pl.col(&#34;col2&#34;) * 2)
    .otherwise(pl.col(&#34;col2&#34;))
    .alias(&#34;col2&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 10   │
│ AB456 ┆ 25   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 20   │
│ AB456 ┆ 25   │
│ GK789 ┆ 30   │
│ CD012 ┆ 80   │
└───────┴──────┘
Extract a column into a vector
col1_vector = df[&#34;col1&#34;].to_list()

print(col1_vector)
[&#39;GK123&#39;, &#39;AB456&#39;, &#39;GK789&#39;, &#39;CD012&#39;]
Extract values meeting a condition from a column
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6]
})

# Extract values from &#39;col1&#39; that are greater than 1
filtered_values = df.filter(pl.col(&#34;col1&#34;) &gt; 1)[&#34;col1&#34;].to_list()

print(filtered_values)
[2, 3]
Get the dimension of the DataFrame
df.shape
(3, 2)
Paste a text string to a range of numbers
# Generate the sequence from 1001 to 1010 and concatenate &#34;DK&#34; with each value
result = [f&#34;DK{1000 &#43; i}&#34; for i in range(1, 11)]

print(result)

result = [&#34;DK&#34; &#43; str(i) for i in range(1001, 1011)]

print(result)
[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
Remove Initial characters in a string list
string_list = [&#34;AB123&#34;, &#34;CD456&#34;, &#34;EF789&#34;, &#34;GH012&#34;]

# Remove the first two characters from each string
modified_list = [s[2:] for s in string_list]

print(modified_list)
[&#39;123&#39;, &#39;456&#39;, &#39;789&#39;, &#39;012&#39;]
Copy a column into another when a condition is met
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

# Copy &#39;col2&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(pl.col(&#34;col2&#34;))  # Copy &#39;col2&#39; value to &#39;col1&#39;
    .otherwise(pl.col(&#34;col1&#34;))  # Keep original &#39;col1&#39; value if condition is not met
    .alias(&#34;col1&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ 10    ┆ 10   │
│ AB456 ┆ 20   │
│ 30    ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
Copy a list into a DataFrame column when a condition is met
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

new_values = [&#34;XY987&#34;, &#34;ZW654&#34;, &#34;XY987&#34;, &#34;ZW654&#34;]

# Copy &#39;new_values&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(pl.Series(new_values))  # Assign new values with the same shape
    .otherwise(pl.col(&#34;col1&#34;))
    .alias(&#34;col1&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ AB456 ┆ 20   │
│ XY987 ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
Copy a list into a column
df = df.with_columns(pl.Series(&#34;col1&#34;, new_values))

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

df = df.with_columns(col1 = pl.lit(pl.Series(new_values)))

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
Copy row-sums (rowSums) of columns &ldquo;a&rdquo; and &ldquo;b&rdquo; into column &ldquo;a&rdquo;
df = pl.DataFrame({
    &#34;a&#34;: [1, 2, 3],
    &#34;b&#34;: [4, 5, 6]
})

# Compute the row-wise sum of columns &#34;a&#34; and &#34;b&#34; and store it in column &#34;a&#34;
df = df.with_columns(
    (pl.col(&#34;a&#34;) &#43; pl.col(&#34;b&#34;)).alias(&#34;a&#34;)
)

print(df)
shape: (3, 2)
┌─────┬─────┐
│ a   ┆ b   │
│ --- ┆ --- │
│ i64 ┆ i64 │
╞═════╪═════╡
│ 5   ┆ 4   │
│ 7   ┆ 5   │
│ 9   ┆ 6   │
└─────┴─────┘
Drop columns with the column name ending with a pattern
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Drop columns that end with &#34;_right&#34;
df = df.select([col for col in df.columns if not col.endswith(&#34;_right&#34;)])

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 1    ┆ 7    │
│ 2    ┆ 8    │
│ 3    ┆ 9    │
└──────┴──────┘
Rename columns with the column name ending with a pattern
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Rename columns ending with &#34;_right&#34; to &#34;d*&#34; (d1, d2, ...)
new_names = {}
counter = 1

for col in df.columns:
    if col.endswith(&#34;_right&#34;):
        new_names[col] = f&#34;d{counter}&#34;
        counter &#43;= 1

# Apply the renaming
df = df.rename(new_names)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Create a dictionary to hold the renaming mappings
new_names = {}

# Iterate through the columns and rename those ending with &#34;_right&#34;
for col in df.columns:
    if col.endswith(&#34;_right&#34;):
        # Extract the part before &#34;_right&#34; and prepend &#34;d&#34;
        base_name = col.split(&#34;_right&#34;)[0]
        new_names[col] = f&#34;d{base_name}&#34;

# Apply the renaming
df = df.rename(new_names)

print(df)
shape: (3, 4)
┌──────┬─────┬──────┬─────┐
│ col1 ┆ d1  ┆ col3 ┆ d2  │
│ ---  ┆ --- ┆ ---  ┆ --- │
│ i64  ┆ i64 ┆ i64  ┆ i64 │
╞══════╪═════╪══════╪═════╡
│ 1    ┆ 4   ┆ 7    ┆ 10  │
│ 2    ┆ 5   ┆ 8    ┆ 11  │
│ 3    ┆ 6   ┆ 9    ┆ 12  │
└──────┴─────┴──────┴─────┘
shape: (3, 4)
┌──────┬───────┬──────┬───────┐
│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 │
│ ---  ┆ ---   ┆ ---  ┆ ---   │
│ i64  ┆ i64   ┆ i64  ┆ i64   │
╞══════╪═══════╪══════╪═══════╡
│ 1    ┆ 4     ┆ 7    ┆ 10    │
│ 2    ┆ 5     ┆ 8    ┆ 11    │
│ 3    ┆ 6     ┆ 9    ┆ 12    │
└──────┴───────┴──────┴───────┘
Rename columns based on column index
df = pl.DataFrame({
    &#34;original1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;],
    &#34;original2&#34;: [1, 2, 3],
    &#34;original3&#34;: [10, 20, 30]
})

# Get the first two column names
old_names = df.columns[:2]

# New names for the first two columns
new_names = [&#34;col1&#34;, &#34;col2&#34;]

# Rename the first two columns
df = df.rename({old_names[0]: new_names[0], old_names[1]: new_names[1]})

print(df)
shape: (3, 3)
┌─────────┬──────┬───────────┐
│ col1    ┆ col2 ┆ original3 │
│ ---     ┆ ---  ┆ ---       │
│ str     ┆ i64  ┆ i64       │
╞═════════╪══════╪═══════════╡
│ 123-456 ┆ 1    ┆ 10        │
│ 789-012 ┆ 2    ┆ 20        │
│ 345-678 ┆ 3    ┆ 30        │
└─────────┴──────┴───────────┘
Rename all columns with a list
df = pl.DataFrame({
    &#34;old_name1&#34;: [1, 2, 3],
    &#34;old_name2&#34;: [4, 5, 6],
    &#34;old_name3&#34;: [7, 8, 9]
})

# List of new column names
new_column_names = [&#34;new_name1&#34;, &#34;new_name2&#34;, &#34;new_name3&#34;]

# Rename all columns
df = df.rename({old: new for old, new in zip(df.columns, new_column_names)})

print(df)
shape: (3, 3)
┌───────────┬───────────┬───────────┐
│ new_name1 ┆ new_name2 ┆ new_name3 │
│ ---       ┆ ---       ┆ ---       │
│ i64       ┆ i64       ┆ i64       │
╞═══════════╪═══════════╪═══════════╡
│ 1         ┆ 4         ┆ 7         │
│ 2         ┆ 5         ┆ 8         │
│ 3         ┆ 6         ┆ 9         │
└───────────┴───────────┴───────────┘
The difference between .str.replace and .str.replace_all
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;123-456-34&#34;, &#34;789-012-78&#34;, &#34;345-678-02&#34;],
    &#34;col2&#34;: [1, 2, 3]
})

# Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column
df = df.with_columns(
    pl.col(&#34;col1&#34;).str.replace(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;)
)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;],
    &#34;col2&#34;: [1, 2, 3]
})

# Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column
df = df.with_columns(
    pl.col(&#34;col1&#34;).str.replace_all(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;)
)

print(df)
shape: (3, 2)
┌───────────┬──────┐
│ col1      ┆ col2 │
│ ---       ┆ ---  │
│ str       ┆ i64  │
╞═══════════╪══════╡
│ 123456-34 ┆ 1    │
│ 789012-78 ┆ 2    │
│ 345678-02 ┆ 3    │
└───────────┴──────┘
shape: (3, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ 123456 ┆ 1    │
│ 789012 ┆ 2    │
│ 345678 ┆ 3    │
└────────┴──────┘
Read specific columns from a CSV file
# df = pl.read_csv(&#34;data.csv&#34;, columns=[0, 2])
Replace null with 0 in the last two columns
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [None, 5, None],
    &#34;col3&#34;: [7, None, 9]
})

# Replace null with 0 in the last two columns
df = df.with_columns(
    [pl.col(df.columns[-2:]).fill_null(0)]
)

print(df)
shape: (3, 3)
┌──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 │
│ ---  ┆ ---  ┆ ---  │
│ i64  ┆ i64  ┆ i64  │
╞══════╪══════╪══════╡
│ 1    ┆ 0    ┆ 7    │
│ 2    ┆ 5    ┆ 0    │
│ 3    ┆ 0    ┆ 9    │
└──────┴──────┴──────┘
Drop the first two characters from all elements in a DataFrame
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;],
    &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;]
})

# Drop the first two characters from all elements in the DataFrame
df = df.with_columns(
    [pl.col(c).str.slice(2) for c in df.columns]
)

print(df)

# Now, do the same, but turn the resulting elements into integers.

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;],
    &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;]
})

# Drop the first two characters and convert the remaining strings to integers
df = df.with_columns(
    [pl.col(c).str.slice(2).cast(pl.Int64) for c in df.columns]
)

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ str  │
╞══════╪══════╡
│ 123  ┆ 001  │
│ 456  ┆ 002  │
│ 789  ┆ 003  │
└──────┴──────┘
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 123  ┆ 1    │
│ 456  ┆ 2    │
│ 789  ┆ 3    │
└──────┴──────┘
Drop a column by its index number
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9]
})

# Drop the first column by its index (0)
df = df.drop(df.columns[0])

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col2 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 4    ┆ 7    │
│ 5    ┆ 8    │
│ 6    ┆ 9    │
└──────┴──────┘
Reorder columns
df.select([&#39;col3&#39;, &#39;col2&#39;])

shape: (3, 2)col3col2i64i64748596
df.select([pl.col(&#39;col3&#39;), pl.col(&#39;col2&#39;)])

shape: (3, 2)col3col2i64i64748596
Reorder DataFrame&rsquo;s rows by matching a column with a list
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;b&#34;, &#34;c&#34;, &#34;a&#34;, &#34;e&#34;, &#34;d&#34;],
    &#34;col2&#34;: [1, 2, 3, 4, 5]
})

# The desired order for &#34;col1&#34;
desired_order = [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;]

# Reorder the DataFrame by matching &#34;col1&#34; with the desired_order list
df_reordered = df.with_columns(
    pl.col(&#34;col1&#34;).map_elements(lambda x: desired_order.index(x), return_dtype=pl.Int64).alias(&#34;sort_key&#34;)
).sort(&#34;sort_key&#34;).drop(&#34;sort_key&#34;)

print(df_reordered)

# or

df_reordered = df.join(pl.DataFrame({&#34;col1&#34;: desired_order}), on = &#34;col1&#34;)

print(df_reordered)
shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
Filter the DataFrame for elements containing a pattern in a column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;abc123&#34;, &#34;def456&#34;, &#34;ghi789&#34;, &#34;abcxyz&#34;],
    &#34;col2&#34;: [1, 2, 3, 4]
})

# Filter rows where &#34;col1&#34; contains the pattern &#34;abc&#34;
filtered_df = df.filter(pl.col(&#34;col1&#34;).str.contains(&#34;abc&#34;))

print(filtered_df)
shape: (2, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ abc123 ┆ 1    │
│ abcxyz ┆ 4    │
└────────┴──────┘
Compute the dot/inner product (crossproduct) between two Series
s = pl.Series(&#34;a&#34;, [1, 2, 3])
s2 = pl.Series(&#34;b&#34;, [4.0, 5.0, 6.0])
s.dot(s2)
32.0
Extract rows of a DataFrame in a list of tuples
print(df.rows())
[(&#39;abc123&#39;, 1), (&#39;def456&#39;, 2), (&#39;ghi789&#39;, 3), (&#39;abcxyz&#39;, 4)]
Get rowSums of a DataFrame
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9]
})

df = df.with_columns(df.select(pl.sum_horizontal(&#34;*&#34;).alias(&#34;row_sum&#34;)))
df.with_columns(df.select(pl.sum_horizontal([&#34;col1&#34;,&#34;col2&#34;]).alias(&#34;row_sum&#34;)))

print(df)
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
head and tail
print(df.head())
print(df.head(2))
print(df.tail())
print(df.tail(2))
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
└──────┴──────┴──────┴─────────┘
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
Matrix-vector multiplication
import numpy as np

a = pl.DataFrame({
    &#34;col1&#34;: [5,1,3,2],
    &#34;col2&#34;: [1,1,1,3],
    &#34;col3&#34;: [1,2,1,4]
})

b = [1, 2, 3]

print(a.to_numpy().dot(b))
[10  9  8 20]
">
<meta name="author" content="Mohammad Ali Nilforooshan">
<link rel="canonical" href="https://nilforooshan.github.io/blog/posts/polars-tutorial2/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://nilforooshan.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://nilforooshan.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://nilforooshan.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://nilforooshan.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://nilforooshan.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://nilforooshan.github.io/blog/posts/polars-tutorial2/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-JH0F7W96MC"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-JH0F7W96MC');
        }
      </script><meta property="og:url" content="https://nilforooshan.github.io/blog/posts/polars-tutorial2/">
  <meta property="og:site_name" content="Mohammad Ali Nilforooshan">
  <meta property="og:title" content="Polars Tutorial2">
  <meta property="og:description" content="Most of these commands are derived with the help of ChatGPT or stackoverflow. However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.
There might be a few Python examples here not directly related to Polars!
Read . as missing value import polars as pl # df = pl.read_csv(&#34;your_file.csv&#34;, null_values=&#34;.&#34;, has_header = True) Replace . with missing value df = pl.DataFrame({ &#34;col1&#34;: [&#34;.&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;.&#34;], &#34;col2&#34;: [10, 20, 30, 40], &#34;col3&#34;: [1, 2, 3, 4] }) df = df.with_columns(pl.col(pl.String).replace({&#34;.&#34;: None})) print(df) shape: (4, 3)┌───────┬──────┬──────┐│ col1 ┆ col2 ┆ col3 ││ --- ┆ --- ┆ --- ││ str ┆ i64 ┆ i64 │╞═══════╪══════╪══════╡│ null ┆ 10 ┆ 1 ││ AB456 ┆ 20 ┆ 2 ││ GK789 ┆ 30 ┆ 3 ││ null ┆ 40 ┆ 4 │└───────┴──────┴──────┘ Get column names df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 20, 30, 40], &#34;col3&#34;: [1, 2, 3, 4] }) print(df.columns) # Get the last two columns print(df.columns[-2:]) # Get the first two columns print(df.columns[:2]) [&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;][&#39;col2&#39;, &#39;col3&#39;][&#39;col1&#39;, &#39;col2&#39;] Change values in a column based on a condition in another column df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 20, 30, 40] }) # Replace values in &#39;col2&#39; based on the condition that &#39;col1&#39; starts with &#39;GK&#39; df = df.with_columns( pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) .then(999) # Replace with your desired value .otherwise(pl.col(&#34;col2&#34;)) # Keep original value if condition is not met .alias(&#34;col2&#34;) ) print(df) shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ GK123 ┆ 999 ││ AB456 ┆ 20 ││ GK789 ┆ 999 ││ CD012 ┆ 40 │└───────┴──────┘ Change values in a column based on multiple conditions in another column df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 25, 30, 40] }) # Replace values in &#39;col2&#39; based on multiple conditions df = df.with_columns( pl.when((pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) &amp; (pl.col(&#34;col2&#34;) &gt; 20)) .then(999) # Replace with your desired value .otherwise(pl.col(&#34;col2&#34;)) # Keep original value if conditions are not met .alias(&#34;col2&#34;) ) print(df) df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 25, 30, 40] }) df = df.with_columns( pl.when(pl.col(&#34;col2&#34;) &lt; 11).then(20) .when(pl.col(&#34;col2&#34;) &gt; 33).then(pl.col(&#34;col2&#34;) * 2) .otherwise(pl.col(&#34;col2&#34;)) .alias(&#34;col2&#34;) ) print(df) shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ GK123 ┆ 10 ││ AB456 ┆ 25 ││ GK789 ┆ 999 ││ CD012 ┆ 40 │└───────┴──────┘shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ GK123 ┆ 20 ││ AB456 ┆ 25 ││ GK789 ┆ 30 ││ CD012 ┆ 80 │└───────┴──────┘ Extract a column into a vector col1_vector = df[&#34;col1&#34;].to_list() print(col1_vector) [&#39;GK123&#39;, &#39;AB456&#39;, &#39;GK789&#39;, &#39;CD012&#39;] Extract values meeting a condition from a column df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2&#34;: [4, 5, 6] }) # Extract values from &#39;col1&#39; that are greater than 1 filtered_values = df.filter(pl.col(&#34;col1&#34;) &gt; 1)[&#34;col1&#34;].to_list() print(filtered_values) [2, 3] Get the dimension of the DataFrame df.shape (3, 2) Paste a text string to a range of numbers # Generate the sequence from 1001 to 1010 and concatenate &#34;DK&#34; with each value result = [f&#34;DK{1000 &#43; i}&#34; for i in range(1, 11)] print(result) result = [&#34;DK&#34; &#43; str(i) for i in range(1001, 1011)] print(result) [&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;][&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;] Remove Initial characters in a string list string_list = [&#34;AB123&#34;, &#34;CD456&#34;, &#34;EF789&#34;, &#34;GH012&#34;] # Remove the first two characters from each string modified_list = [s[2:] for s in string_list] print(modified_list) [&#39;123&#39;, &#39;456&#39;, &#39;789&#39;, &#39;012&#39;] Copy a column into another when a condition is met df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 20, 30, 40] }) # Copy &#39;col2&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39; df = df.with_columns( pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) .then(pl.col(&#34;col2&#34;)) # Copy &#39;col2&#39; value to &#39;col1&#39; .otherwise(pl.col(&#34;col1&#34;)) # Keep original &#39;col1&#39; value if condition is not met .alias(&#34;col1&#34;) ) print(df) shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ 10 ┆ 10 ││ AB456 ┆ 20 ││ 30 ┆ 30 ││ CD012 ┆ 40 │└───────┴──────┘ Copy a list into a DataFrame column when a condition is met df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 20, 30, 40] }) new_values = [&#34;XY987&#34;, &#34;ZW654&#34;, &#34;XY987&#34;, &#34;ZW654&#34;] # Copy &#39;new_values&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39; df = df.with_columns( pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) .then(pl.Series(new_values)) # Assign new values with the same shape .otherwise(pl.col(&#34;col1&#34;)) .alias(&#34;col1&#34;) ) print(df) shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ XY987 ┆ 10 ││ AB456 ┆ 20 ││ XY987 ┆ 30 ││ CD012 ┆ 40 │└───────┴──────┘ Copy a list into a column df = df.with_columns(pl.Series(&#34;col1&#34;, new_values)) print(df) df = pl.DataFrame({ &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;], &#34;col2&#34;: [10, 20, 30, 40] }) df = df.with_columns(col1 = pl.lit(pl.Series(new_values))) print(df) shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ XY987 ┆ 10 ││ ZW654 ┆ 20 ││ XY987 ┆ 30 ││ ZW654 ┆ 40 │└───────┴──────┘shape: (4, 2)┌───────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════╪══════╡│ XY987 ┆ 10 ││ ZW654 ┆ 20 ││ XY987 ┆ 30 ││ ZW654 ┆ 40 │└───────┴──────┘ Copy row-sums (rowSums) of columns “a” and “b” into column “a” df = pl.DataFrame({ &#34;a&#34;: [1, 2, 3], &#34;b&#34;: [4, 5, 6] }) # Compute the row-wise sum of columns &#34;a&#34; and &#34;b&#34; and store it in column &#34;a&#34; df = df.with_columns( (pl.col(&#34;a&#34;) &#43; pl.col(&#34;b&#34;)).alias(&#34;a&#34;) ) print(df) shape: (3, 2)┌─────┬─────┐│ a ┆ b ││ --- ┆ --- ││ i64 ┆ i64 │╞═════╪═════╡│ 5 ┆ 4 ││ 7 ┆ 5 ││ 9 ┆ 6 │└─────┴─────┘ Drop columns with the column name ending with a pattern df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2_right&#34;: [4, 5, 6], &#34;col3&#34;: [7, 8, 9], &#34;col4_right&#34;: [10, 11, 12] }) # Drop columns that end with &#34;_right&#34; df = df.select([col for col in df.columns if not col.endswith(&#34;_right&#34;)]) print(df) shape: (3, 2)┌──────┬──────┐│ col1 ┆ col3 ││ --- ┆ --- ││ i64 ┆ i64 │╞══════╪══════╡│ 1 ┆ 7 ││ 2 ┆ 8 ││ 3 ┆ 9 │└──────┴──────┘ Rename columns with the column name ending with a pattern df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2_right&#34;: [4, 5, 6], &#34;col3&#34;: [7, 8, 9], &#34;col4_right&#34;: [10, 11, 12] }) # Rename columns ending with &#34;_right&#34; to &#34;d*&#34; (d1, d2, ...) new_names = {} counter = 1 for col in df.columns: if col.endswith(&#34;_right&#34;): new_names[col] = f&#34;d{counter}&#34; counter &#43;= 1 # Apply the renaming df = df.rename(new_names) print(df) df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2_right&#34;: [4, 5, 6], &#34;col3&#34;: [7, 8, 9], &#34;col4_right&#34;: [10, 11, 12] }) # Create a dictionary to hold the renaming mappings new_names = {} # Iterate through the columns and rename those ending with &#34;_right&#34; for col in df.columns: if col.endswith(&#34;_right&#34;): # Extract the part before &#34;_right&#34; and prepend &#34;d&#34; base_name = col.split(&#34;_right&#34;)[0] new_names[col] = f&#34;d{base_name}&#34; # Apply the renaming df = df.rename(new_names) print(df) shape: (3, 4)┌──────┬─────┬──────┬─────┐│ col1 ┆ d1 ┆ col3 ┆ d2 ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪═════╪══════╪═════╡│ 1 ┆ 4 ┆ 7 ┆ 10 ││ 2 ┆ 5 ┆ 8 ┆ 11 ││ 3 ┆ 6 ┆ 9 ┆ 12 │└──────┴─────┴──────┴─────┘shape: (3, 4)┌──────┬───────┬──────┬───────┐│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪═══════╪══════╪═══════╡│ 1 ┆ 4 ┆ 7 ┆ 10 ││ 2 ┆ 5 ┆ 8 ┆ 11 ││ 3 ┆ 6 ┆ 9 ┆ 12 │└──────┴───────┴──────┴───────┘ Rename columns based on column index df = pl.DataFrame({ &#34;original1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;], &#34;original2&#34;: [1, 2, 3], &#34;original3&#34;: [10, 20, 30] }) # Get the first two column names old_names = df.columns[:2] # New names for the first two columns new_names = [&#34;col1&#34;, &#34;col2&#34;] # Rename the first two columns df = df.rename({old_names[0]: new_names[0], old_names[1]: new_names[1]}) print(df) shape: (3, 3)┌─────────┬──────┬───────────┐│ col1 ┆ col2 ┆ original3 ││ --- ┆ --- ┆ --- ││ str ┆ i64 ┆ i64 │╞═════════╪══════╪═══════════╡│ 123-456 ┆ 1 ┆ 10 ││ 789-012 ┆ 2 ┆ 20 ││ 345-678 ┆ 3 ┆ 30 │└─────────┴──────┴───────────┘ Rename all columns with a list df = pl.DataFrame({ &#34;old_name1&#34;: [1, 2, 3], &#34;old_name2&#34;: [4, 5, 6], &#34;old_name3&#34;: [7, 8, 9] }) # List of new column names new_column_names = [&#34;new_name1&#34;, &#34;new_name2&#34;, &#34;new_name3&#34;] # Rename all columns df = df.rename({old: new for old, new in zip(df.columns, new_column_names)}) print(df) shape: (3, 3)┌───────────┬───────────┬───────────┐│ new_name1 ┆ new_name2 ┆ new_name3 ││ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 │╞═══════════╪═══════════╪═══════════╡│ 1 ┆ 4 ┆ 7 ││ 2 ┆ 5 ┆ 8 ││ 3 ┆ 6 ┆ 9 │└───────────┴───────────┴───────────┘ The difference between .str.replace and .str.replace_all df = pl.DataFrame({ &#34;col1&#34;: [&#34;123-456-34&#34;, &#34;789-012-78&#34;, &#34;345-678-02&#34;], &#34;col2&#34;: [1, 2, 3] }) # Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column df = df.with_columns( pl.col(&#34;col1&#34;).str.replace(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;) ) print(df) df = pl.DataFrame({ &#34;col1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;], &#34;col2&#34;: [1, 2, 3] }) # Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column df = df.with_columns( pl.col(&#34;col1&#34;).str.replace_all(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;) ) print(df) shape: (3, 2)┌───────────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞═══════════╪══════╡│ 123456-34 ┆ 1 ││ 789012-78 ┆ 2 ││ 345678-02 ┆ 3 │└───────────┴──────┘shape: (3, 2)┌────────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞════════╪══════╡│ 123456 ┆ 1 ││ 789012 ┆ 2 ││ 345678 ┆ 3 │└────────┴──────┘ Read specific columns from a CSV file # df = pl.read_csv(&#34;data.csv&#34;, columns=[0, 2]) Replace null with 0 in the last two columns df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2&#34;: [None, 5, None], &#34;col3&#34;: [7, None, 9] }) # Replace null with 0 in the last two columns df = df.with_columns( [pl.col(df.columns[-2:]).fill_null(0)] ) print(df) shape: (3, 3)┌──────┬──────┬──────┐│ col1 ┆ col2 ┆ col3 ││ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╡│ 1 ┆ 0 ┆ 7 ││ 2 ┆ 5 ┆ 0 ││ 3 ┆ 0 ┆ 9 │└──────┴──────┴──────┘ Drop the first two characters from all elements in a DataFrame df = pl.DataFrame({ &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;], &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;] }) # Drop the first two characters from all elements in the DataFrame df = df.with_columns( [pl.col(c).str.slice(2) for c in df.columns] ) print(df) # Now, do the same, but turn the resulting elements into integers. df = pl.DataFrame({ &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;], &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;] }) # Drop the first two characters and convert the remaining strings to integers df = df.with_columns( [pl.col(c).str.slice(2).cast(pl.Int64) for c in df.columns] ) print(df) shape: (3, 2)┌──────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ str │╞══════╪══════╡│ 123 ┆ 001 ││ 456 ┆ 002 ││ 789 ┆ 003 │└──────┴──────┘shape: (3, 2)┌──────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ i64 ┆ i64 │╞══════╪══════╡│ 123 ┆ 1 ││ 456 ┆ 2 ││ 789 ┆ 3 │└──────┴──────┘ Drop a column by its index number df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2&#34;: [4, 5, 6], &#34;col3&#34;: [7, 8, 9] }) # Drop the first column by its index (0) df = df.drop(df.columns[0]) print(df) shape: (3, 2)┌──────┬──────┐│ col2 ┆ col3 ││ --- ┆ --- ││ i64 ┆ i64 │╞══════╪══════╡│ 4 ┆ 7 ││ 5 ┆ 8 ││ 6 ┆ 9 │└──────┴──────┘ Reorder columns df.select([&#39;col3&#39;, &#39;col2&#39;]) shape: (3, 2)col3col2i64i64748596df.select([pl.col(&#39;col3&#39;), pl.col(&#39;col2&#39;)]) shape: (3, 2)col3col2i64i64748596Reorder DataFrame’s rows by matching a column with a list df = pl.DataFrame({ &#34;col1&#34;: [&#34;b&#34;, &#34;c&#34;, &#34;a&#34;, &#34;e&#34;, &#34;d&#34;], &#34;col2&#34;: [1, 2, 3, 4, 5] }) # The desired order for &#34;col1&#34; desired_order = [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;] # Reorder the DataFrame by matching &#34;col1&#34; with the desired_order list df_reordered = df.with_columns( pl.col(&#34;col1&#34;).map_elements(lambda x: desired_order.index(x), return_dtype=pl.Int64).alias(&#34;sort_key&#34;) ).sort(&#34;sort_key&#34;).drop(&#34;sort_key&#34;) print(df_reordered) # or df_reordered = df.join(pl.DataFrame({&#34;col1&#34;: desired_order}), on = &#34;col1&#34;) print(df_reordered) shape: (5, 2)┌──────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞══════╪══════╡│ a ┆ 3 ││ b ┆ 1 ││ c ┆ 2 ││ d ┆ 5 ││ e ┆ 4 │└──────┴──────┘shape: (5, 2)┌──────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞══════╪══════╡│ a ┆ 3 ││ b ┆ 1 ││ c ┆ 2 ││ d ┆ 5 ││ e ┆ 4 │└──────┴──────┘ Filter the DataFrame for elements containing a pattern in a column df = pl.DataFrame({ &#34;col1&#34;: [&#34;abc123&#34;, &#34;def456&#34;, &#34;ghi789&#34;, &#34;abcxyz&#34;], &#34;col2&#34;: [1, 2, 3, 4] }) # Filter rows where &#34;col1&#34; contains the pattern &#34;abc&#34; filtered_df = df.filter(pl.col(&#34;col1&#34;).str.contains(&#34;abc&#34;)) print(filtered_df) shape: (2, 2)┌────────┬──────┐│ col1 ┆ col2 ││ --- ┆ --- ││ str ┆ i64 │╞════════╪══════╡│ abc123 ┆ 1 ││ abcxyz ┆ 4 │└────────┴──────┘ Compute the dot/inner product (crossproduct) between two Series s = pl.Series(&#34;a&#34;, [1, 2, 3]) s2 = pl.Series(&#34;b&#34;, [4.0, 5.0, 6.0]) s.dot(s2) 32.0 Extract rows of a DataFrame in a list of tuples print(df.rows()) [(&#39;abc123&#39;, 1), (&#39;def456&#39;, 2), (&#39;ghi789&#39;, 3), (&#39;abcxyz&#39;, 4)] Get rowSums of a DataFrame df = pl.DataFrame({ &#34;col1&#34;: [1, 2, 3], &#34;col2&#34;: [4, 5, 6], &#34;col3&#34;: [7, 8, 9] }) df = df.with_columns(df.select(pl.sum_horizontal(&#34;*&#34;).alias(&#34;row_sum&#34;))) df.with_columns(df.select(pl.sum_horizontal([&#34;col1&#34;,&#34;col2&#34;]).alias(&#34;row_sum&#34;))) print(df) shape: (3, 4)┌──────┬──────┬──────┬─────────┐│ col1 ┆ col2 ┆ col3 ┆ row_sum ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╪═════════╡│ 1 ┆ 4 ┆ 7 ┆ 12 ││ 2 ┆ 5 ┆ 8 ┆ 15 ││ 3 ┆ 6 ┆ 9 ┆ 18 │└──────┴──────┴──────┴─────────┘ head and tail print(df.head()) print(df.head(2)) print(df.tail()) print(df.tail(2)) shape: (3, 4)┌──────┬──────┬──────┬─────────┐│ col1 ┆ col2 ┆ col3 ┆ row_sum ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╪═════════╡│ 1 ┆ 4 ┆ 7 ┆ 12 ││ 2 ┆ 5 ┆ 8 ┆ 15 ││ 3 ┆ 6 ┆ 9 ┆ 18 │└──────┴──────┴──────┴─────────┘shape: (2, 4)┌──────┬──────┬──────┬─────────┐│ col1 ┆ col2 ┆ col3 ┆ row_sum ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╪═════════╡│ 1 ┆ 4 ┆ 7 ┆ 12 ││ 2 ┆ 5 ┆ 8 ┆ 15 │└──────┴──────┴──────┴─────────┘shape: (3, 4)┌──────┬──────┬──────┬─────────┐│ col1 ┆ col2 ┆ col3 ┆ row_sum ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╪═════════╡│ 1 ┆ 4 ┆ 7 ┆ 12 ││ 2 ┆ 5 ┆ 8 ┆ 15 ││ 3 ┆ 6 ┆ 9 ┆ 18 │└──────┴──────┴──────┴─────────┘shape: (2, 4)┌──────┬──────┬──────┬─────────┐│ col1 ┆ col2 ┆ col3 ┆ row_sum ││ --- ┆ --- ┆ --- ┆ --- ││ i64 ┆ i64 ┆ i64 ┆ i64 │╞══════╪══════╪══════╪═════════╡│ 2 ┆ 5 ┆ 8 ┆ 15 ││ 3 ┆ 6 ┆ 9 ┆ 18 │└──────┴──────┴──────┴─────────┘ Matrix-vector multiplication import numpy as np a = pl.DataFrame({ &#34;col1&#34;: [5,1,3,2], &#34;col2&#34;: [1,1,1,3], &#34;col3&#34;: [1,2,1,4] }) b = [1, 2, 3] print(a.to_numpy().dot(b)) [10 9 8 20] ">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-25T00:00:00+00:00">
    <meta property="article:tag" content="Python">
      <meta property="og:image" content="https://nilforooshan.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://nilforooshan.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name="twitter:title" content="Polars Tutorial2">
<meta name="twitter:description" content="Most of these commands are derived with the help of ChatGPT or stackoverflow.
However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.
There might be a few Python examples here not directly related to Polars!
Read . as missing value
import polars as pl
# df = pl.read_csv(&#34;your_file.csv&#34;, null_values=&#34;.&#34;, has_header = True)
Replace . with missing value
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;.&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;.&#34;],
    &#34;col2&#34;: [10, 20, 30, 40],
    &#34;col3&#34;: [1, 2, 3, 4]
})

df = df.with_columns(pl.col(pl.String).replace({&#34;.&#34;: None}))

print(df)
shape: (4, 3)
┌───────┬──────┬──────┐
│ col1  ┆ col2 ┆ col3 │
│ ---   ┆ ---  ┆ ---  │
│ str   ┆ i64  ┆ i64  │
╞═══════╪══════╪══════╡
│ null  ┆ 10   ┆ 1    │
│ AB456 ┆ 20   ┆ 2    │
│ GK789 ┆ 30   ┆ 3    │
│ null  ┆ 40   ┆ 4    │
└───────┴──────┴──────┘
Get column names
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40],
    &#34;col3&#34;: [1, 2, 3, 4]
})

print(df.columns)

# Get the last two columns
print(df.columns[-2:])

# Get the first two columns
print(df.columns[:2])
[&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;]
[&#39;col2&#39;, &#39;col3&#39;]
[&#39;col1&#39;, &#39;col2&#39;]
Change values in a column based on a condition in another column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

# Replace values in &#39;col2&#39; based on the condition that &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(999)  # Replace with your desired value
    .otherwise(pl.col(&#34;col2&#34;))  # Keep original value if condition is not met
    .alias(&#34;col2&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 999  │
│ AB456 ┆ 20   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
Change values in a column based on multiple conditions in another column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 25, 30, 40]
})

# Replace values in &#39;col2&#39; based on multiple conditions
df = df.with_columns(
    pl.when((pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;)) &amp; (pl.col(&#34;col2&#34;) &gt; 20))
    .then(999)  # Replace with your desired value
    .otherwise(pl.col(&#34;col2&#34;))  # Keep original value if conditions are not met
    .alias(&#34;col2&#34;)
)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 25, 30, 40]
})

df = df.with_columns(
    pl.when(pl.col(&#34;col2&#34;) &lt; 11).then(20)
    .when(pl.col(&#34;col2&#34;) &gt; 33).then(pl.col(&#34;col2&#34;) * 2)
    .otherwise(pl.col(&#34;col2&#34;))
    .alias(&#34;col2&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 10   │
│ AB456 ┆ 25   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 20   │
│ AB456 ┆ 25   │
│ GK789 ┆ 30   │
│ CD012 ┆ 80   │
└───────┴──────┘
Extract a column into a vector
col1_vector = df[&#34;col1&#34;].to_list()

print(col1_vector)
[&#39;GK123&#39;, &#39;AB456&#39;, &#39;GK789&#39;, &#39;CD012&#39;]
Extract values meeting a condition from a column
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6]
})

# Extract values from &#39;col1&#39; that are greater than 1
filtered_values = df.filter(pl.col(&#34;col1&#34;) &gt; 1)[&#34;col1&#34;].to_list()

print(filtered_values)
[2, 3]
Get the dimension of the DataFrame
df.shape
(3, 2)
Paste a text string to a range of numbers
# Generate the sequence from 1001 to 1010 and concatenate &#34;DK&#34; with each value
result = [f&#34;DK{1000 &#43; i}&#34; for i in range(1, 11)]

print(result)

result = [&#34;DK&#34; &#43; str(i) for i in range(1001, 1011)]

print(result)
[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
Remove Initial characters in a string list
string_list = [&#34;AB123&#34;, &#34;CD456&#34;, &#34;EF789&#34;, &#34;GH012&#34;]

# Remove the first two characters from each string
modified_list = [s[2:] for s in string_list]

print(modified_list)
[&#39;123&#39;, &#39;456&#39;, &#39;789&#39;, &#39;012&#39;]
Copy a column into another when a condition is met
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

# Copy &#39;col2&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(pl.col(&#34;col2&#34;))  # Copy &#39;col2&#39; value to &#39;col1&#39;
    .otherwise(pl.col(&#34;col1&#34;))  # Keep original &#39;col1&#39; value if condition is not met
    .alias(&#34;col1&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ 10    ┆ 10   │
│ AB456 ┆ 20   │
│ 30    ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
Copy a list into a DataFrame column when a condition is met
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

new_values = [&#34;XY987&#34;, &#34;ZW654&#34;, &#34;XY987&#34;, &#34;ZW654&#34;]

# Copy &#39;new_values&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;
df = df.with_columns(
    pl.when(pl.col(&#34;col1&#34;).str.starts_with(&#34;GK&#34;))
    .then(pl.Series(new_values))  # Assign new values with the same shape
    .otherwise(pl.col(&#34;col1&#34;))
    .alias(&#34;col1&#34;)
)

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ AB456 ┆ 20   │
│ XY987 ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
Copy a list into a column
df = df.with_columns(pl.Series(&#34;col1&#34;, new_values))

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;GK123&#34;, &#34;AB456&#34;, &#34;GK789&#34;, &#34;CD012&#34;],
    &#34;col2&#34;: [10, 20, 30, 40]
})

df = df.with_columns(col1 = pl.lit(pl.Series(new_values)))

print(df)
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
Copy row-sums (rowSums) of columns &ldquo;a&rdquo; and &ldquo;b&rdquo; into column &ldquo;a&rdquo;
df = pl.DataFrame({
    &#34;a&#34;: [1, 2, 3],
    &#34;b&#34;: [4, 5, 6]
})

# Compute the row-wise sum of columns &#34;a&#34; and &#34;b&#34; and store it in column &#34;a&#34;
df = df.with_columns(
    (pl.col(&#34;a&#34;) &#43; pl.col(&#34;b&#34;)).alias(&#34;a&#34;)
)

print(df)
shape: (3, 2)
┌─────┬─────┐
│ a   ┆ b   │
│ --- ┆ --- │
│ i64 ┆ i64 │
╞═════╪═════╡
│ 5   ┆ 4   │
│ 7   ┆ 5   │
│ 9   ┆ 6   │
└─────┴─────┘
Drop columns with the column name ending with a pattern
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Drop columns that end with &#34;_right&#34;
df = df.select([col for col in df.columns if not col.endswith(&#34;_right&#34;)])

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 1    ┆ 7    │
│ 2    ┆ 8    │
│ 3    ┆ 9    │
└──────┴──────┘
Rename columns with the column name ending with a pattern
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Rename columns ending with &#34;_right&#34; to &#34;d*&#34; (d1, d2, ...)
new_names = {}
counter = 1

for col in df.columns:
    if col.endswith(&#34;_right&#34;):
        new_names[col] = f&#34;d{counter}&#34;
        counter &#43;= 1

# Apply the renaming
df = df.rename(new_names)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2_right&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9],
    &#34;col4_right&#34;: [10, 11, 12]
})

# Create a dictionary to hold the renaming mappings
new_names = {}

# Iterate through the columns and rename those ending with &#34;_right&#34;
for col in df.columns:
    if col.endswith(&#34;_right&#34;):
        # Extract the part before &#34;_right&#34; and prepend &#34;d&#34;
        base_name = col.split(&#34;_right&#34;)[0]
        new_names[col] = f&#34;d{base_name}&#34;

# Apply the renaming
df = df.rename(new_names)

print(df)
shape: (3, 4)
┌──────┬─────┬──────┬─────┐
│ col1 ┆ d1  ┆ col3 ┆ d2  │
│ ---  ┆ --- ┆ ---  ┆ --- │
│ i64  ┆ i64 ┆ i64  ┆ i64 │
╞══════╪═════╪══════╪═════╡
│ 1    ┆ 4   ┆ 7    ┆ 10  │
│ 2    ┆ 5   ┆ 8    ┆ 11  │
│ 3    ┆ 6   ┆ 9    ┆ 12  │
└──────┴─────┴──────┴─────┘
shape: (3, 4)
┌──────┬───────┬──────┬───────┐
│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 │
│ ---  ┆ ---   ┆ ---  ┆ ---   │
│ i64  ┆ i64   ┆ i64  ┆ i64   │
╞══════╪═══════╪══════╪═══════╡
│ 1    ┆ 4     ┆ 7    ┆ 10    │
│ 2    ┆ 5     ┆ 8    ┆ 11    │
│ 3    ┆ 6     ┆ 9    ┆ 12    │
└──────┴───────┴──────┴───────┘
Rename columns based on column index
df = pl.DataFrame({
    &#34;original1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;],
    &#34;original2&#34;: [1, 2, 3],
    &#34;original3&#34;: [10, 20, 30]
})

# Get the first two column names
old_names = df.columns[:2]

# New names for the first two columns
new_names = [&#34;col1&#34;, &#34;col2&#34;]

# Rename the first two columns
df = df.rename({old_names[0]: new_names[0], old_names[1]: new_names[1]})

print(df)
shape: (3, 3)
┌─────────┬──────┬───────────┐
│ col1    ┆ col2 ┆ original3 │
│ ---     ┆ ---  ┆ ---       │
│ str     ┆ i64  ┆ i64       │
╞═════════╪══════╪═══════════╡
│ 123-456 ┆ 1    ┆ 10        │
│ 789-012 ┆ 2    ┆ 20        │
│ 345-678 ┆ 3    ┆ 30        │
└─────────┴──────┴───────────┘
Rename all columns with a list
df = pl.DataFrame({
    &#34;old_name1&#34;: [1, 2, 3],
    &#34;old_name2&#34;: [4, 5, 6],
    &#34;old_name3&#34;: [7, 8, 9]
})

# List of new column names
new_column_names = [&#34;new_name1&#34;, &#34;new_name2&#34;, &#34;new_name3&#34;]

# Rename all columns
df = df.rename({old: new for old, new in zip(df.columns, new_column_names)})

print(df)
shape: (3, 3)
┌───────────┬───────────┬───────────┐
│ new_name1 ┆ new_name2 ┆ new_name3 │
│ ---       ┆ ---       ┆ ---       │
│ i64       ┆ i64       ┆ i64       │
╞═══════════╪═══════════╪═══════════╡
│ 1         ┆ 4         ┆ 7         │
│ 2         ┆ 5         ┆ 8         │
│ 3         ┆ 6         ┆ 9         │
└───────────┴───────────┴───────────┘
The difference between .str.replace and .str.replace_all
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;123-456-34&#34;, &#34;789-012-78&#34;, &#34;345-678-02&#34;],
    &#34;col2&#34;: [1, 2, 3]
})

# Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column
df = df.with_columns(
    pl.col(&#34;col1&#34;).str.replace(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;)
)

print(df)

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;123-456&#34;, &#34;789-012&#34;, &#34;345-678&#34;],
    &#34;col2&#34;: [1, 2, 3]
})

# Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column
df = df.with_columns(
    pl.col(&#34;col1&#34;).str.replace_all(&#34;-&#34;, &#34;&#34;).alias(&#34;col1&#34;)
)

print(df)
shape: (3, 2)
┌───────────┬──────┐
│ col1      ┆ col2 │
│ ---       ┆ ---  │
│ str       ┆ i64  │
╞═══════════╪══════╡
│ 123456-34 ┆ 1    │
│ 789012-78 ┆ 2    │
│ 345678-02 ┆ 3    │
└───────────┴──────┘
shape: (3, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ 123456 ┆ 1    │
│ 789012 ┆ 2    │
│ 345678 ┆ 3    │
└────────┴──────┘
Read specific columns from a CSV file
# df = pl.read_csv(&#34;data.csv&#34;, columns=[0, 2])
Replace null with 0 in the last two columns
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [None, 5, None],
    &#34;col3&#34;: [7, None, 9]
})

# Replace null with 0 in the last two columns
df = df.with_columns(
    [pl.col(df.columns[-2:]).fill_null(0)]
)

print(df)
shape: (3, 3)
┌──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 │
│ ---  ┆ ---  ┆ ---  │
│ i64  ┆ i64  ┆ i64  │
╞══════╪══════╪══════╡
│ 1    ┆ 0    ┆ 7    │
│ 2    ┆ 5    ┆ 0    │
│ 3    ┆ 0    ┆ 9    │
└──────┴──────┴──────┘
Drop the first two characters from all elements in a DataFrame
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;],
    &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;]
})

# Drop the first two characters from all elements in the DataFrame
df = df.with_columns(
    [pl.col(c).str.slice(2) for c in df.columns]
)

print(df)

# Now, do the same, but turn the resulting elements into integers.

df = pl.DataFrame({
    &#34;col1&#34;: [&#34;ab123&#34;, &#34;ab456&#34;, &#34;ab789&#34;],
    &#34;col2&#34;: [&#34;cd001&#34;, &#34;cd002&#34;, &#34;cd003&#34;]
})

# Drop the first two characters and convert the remaining strings to integers
df = df.with_columns(
    [pl.col(c).str.slice(2).cast(pl.Int64) for c in df.columns]
)

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ str  │
╞══════╪══════╡
│ 123  ┆ 001  │
│ 456  ┆ 002  │
│ 789  ┆ 003  │
└──────┴──────┘
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 123  ┆ 1    │
│ 456  ┆ 2    │
│ 789  ┆ 3    │
└──────┴──────┘
Drop a column by its index number
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9]
})

# Drop the first column by its index (0)
df = df.drop(df.columns[0])

print(df)
shape: (3, 2)
┌──────┬──────┐
│ col2 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 4    ┆ 7    │
│ 5    ┆ 8    │
│ 6    ┆ 9    │
└──────┴──────┘
Reorder columns
df.select([&#39;col3&#39;, &#39;col2&#39;])

shape: (3, 2)col3col2i64i64748596
df.select([pl.col(&#39;col3&#39;), pl.col(&#39;col2&#39;)])

shape: (3, 2)col3col2i64i64748596
Reorder DataFrame&rsquo;s rows by matching a column with a list
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;b&#34;, &#34;c&#34;, &#34;a&#34;, &#34;e&#34;, &#34;d&#34;],
    &#34;col2&#34;: [1, 2, 3, 4, 5]
})

# The desired order for &#34;col1&#34;
desired_order = [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;e&#34;]

# Reorder the DataFrame by matching &#34;col1&#34; with the desired_order list
df_reordered = df.with_columns(
    pl.col(&#34;col1&#34;).map_elements(lambda x: desired_order.index(x), return_dtype=pl.Int64).alias(&#34;sort_key&#34;)
).sort(&#34;sort_key&#34;).drop(&#34;sort_key&#34;)

print(df_reordered)

# or

df_reordered = df.join(pl.DataFrame({&#34;col1&#34;: desired_order}), on = &#34;col1&#34;)

print(df_reordered)
shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
Filter the DataFrame for elements containing a pattern in a column
df = pl.DataFrame({
    &#34;col1&#34;: [&#34;abc123&#34;, &#34;def456&#34;, &#34;ghi789&#34;, &#34;abcxyz&#34;],
    &#34;col2&#34;: [1, 2, 3, 4]
})

# Filter rows where &#34;col1&#34; contains the pattern &#34;abc&#34;
filtered_df = df.filter(pl.col(&#34;col1&#34;).str.contains(&#34;abc&#34;))

print(filtered_df)
shape: (2, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ abc123 ┆ 1    │
│ abcxyz ┆ 4    │
└────────┴──────┘
Compute the dot/inner product (crossproduct) between two Series
s = pl.Series(&#34;a&#34;, [1, 2, 3])
s2 = pl.Series(&#34;b&#34;, [4.0, 5.0, 6.0])
s.dot(s2)
32.0
Extract rows of a DataFrame in a list of tuples
print(df.rows())
[(&#39;abc123&#39;, 1), (&#39;def456&#39;, 2), (&#39;ghi789&#39;, 3), (&#39;abcxyz&#39;, 4)]
Get rowSums of a DataFrame
df = pl.DataFrame({
    &#34;col1&#34;: [1, 2, 3],
    &#34;col2&#34;: [4, 5, 6],
    &#34;col3&#34;: [7, 8, 9]
})

df = df.with_columns(df.select(pl.sum_horizontal(&#34;*&#34;).alias(&#34;row_sum&#34;)))
df.with_columns(df.select(pl.sum_horizontal([&#34;col1&#34;,&#34;col2&#34;]).alias(&#34;row_sum&#34;)))

print(df)
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
head and tail
print(df.head())
print(df.head(2))
print(df.tail())
print(df.tail(2))
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
└──────┴──────┴──────┴─────────┘
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
Matrix-vector multiplication
import numpy as np

a = pl.DataFrame({
    &#34;col1&#34;: [5,1,3,2],
    &#34;col2&#34;: [1,1,1,3],
    &#34;col3&#34;: [1,2,1,4]
})

b = [1, 2, 3]

print(a.to_numpy().dot(b))
[10  9  8 20]
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://nilforooshan.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Polars Tutorial2",
      "item": "https://nilforooshan.github.io/blog/posts/polars-tutorial2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Polars Tutorial2",
  "name": "Polars Tutorial2",
  "description": "Most of these commands are derived with the help of ChatGPT or stackoverflow. However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.\nThere might be a few Python examples here not directly related to Polars!\nRead . as missing value import polars as pl # df = pl.read_csv(\u0026#34;your_file.csv\u0026#34;, null_values=\u0026#34;.\u0026#34;, has_header = True) Replace . with missing value df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;.\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;.\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40], \u0026#34;col3\u0026#34;: [1, 2, 3, 4] }) df = df.with_columns(pl.col(pl.String).replace({\u0026#34;.\u0026#34;: None})) print(df) shape: (4, 3)\r┌───────┬──────┬──────┐\r│ col1 ┆ col2 ┆ col3 │\r│ --- ┆ --- ┆ --- │\r│ str ┆ i64 ┆ i64 │\r╞═══════╪══════╪══════╡\r│ null ┆ 10 ┆ 1 │\r│ AB456 ┆ 20 ┆ 2 │\r│ GK789 ┆ 30 ┆ 3 │\r│ null ┆ 40 ┆ 4 │\r└───────┴──────┴──────┘ Get column names df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40], \u0026#34;col3\u0026#34;: [1, 2, 3, 4] }) print(df.columns) # Get the last two columns print(df.columns[-2:]) # Get the first two columns print(df.columns[:2]) [\u0026#39;col1\u0026#39;, \u0026#39;col2\u0026#39;, \u0026#39;col3\u0026#39;]\r[\u0026#39;col2\u0026#39;, \u0026#39;col3\u0026#39;]\r[\u0026#39;col1\u0026#39;, \u0026#39;col2\u0026#39;] Change values in a column based on a condition in another column df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40] }) # Replace values in \u0026#39;col2\u0026#39; based on the condition that \u0026#39;col1\u0026#39; starts with \u0026#39;GK\u0026#39; df = df.with_columns( pl.when(pl.col(\u0026#34;col1\u0026#34;).str.starts_with(\u0026#34;GK\u0026#34;)) .then(999) # Replace with your desired value .otherwise(pl.col(\u0026#34;col2\u0026#34;)) # Keep original value if condition is not met .alias(\u0026#34;col2\u0026#34;) ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 999 │\r│ AB456 ┆ 20 │\r│ GK789 ┆ 999 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Change values in a column based on multiple conditions in another column df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 25, 30, 40] }) # Replace values in \u0026#39;col2\u0026#39; based on multiple conditions df = df.with_columns( pl.when((pl.col(\u0026#34;col1\u0026#34;).str.starts_with(\u0026#34;GK\u0026#34;)) \u0026amp; (pl.col(\u0026#34;col2\u0026#34;) \u0026gt; 20)) .then(999) # Replace with your desired value .otherwise(pl.col(\u0026#34;col2\u0026#34;)) # Keep original value if conditions are not met .alias(\u0026#34;col2\u0026#34;) ) print(df) df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 25, 30, 40] }) df = df.with_columns( pl.when(pl.col(\u0026#34;col2\u0026#34;) \u0026lt; 11).then(20) .when(pl.col(\u0026#34;col2\u0026#34;) \u0026gt; 33).then(pl.col(\u0026#34;col2\u0026#34;) * 2) .otherwise(pl.col(\u0026#34;col2\u0026#34;)) .alias(\u0026#34;col2\u0026#34;) ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 10 │\r│ AB456 ┆ 25 │\r│ GK789 ┆ 999 │\r│ CD012 ┆ 40 │\r└───────┴──────┘\rshape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 20 │\r│ AB456 ┆ 25 │\r│ GK789 ┆ 30 │\r│ CD012 ┆ 80 │\r└───────┴──────┘ Extract a column into a vector col1_vector = df[\u0026#34;col1\u0026#34;].to_list() print(col1_vector) [\u0026#39;GK123\u0026#39;, \u0026#39;AB456\u0026#39;, \u0026#39;GK789\u0026#39;, \u0026#39;CD012\u0026#39;] Extract values meeting a condition from a column df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2\u0026#34;: [4, 5, 6] }) # Extract values from \u0026#39;col1\u0026#39; that are greater than 1 filtered_values = df.filter(pl.col(\u0026#34;col1\u0026#34;) \u0026gt; 1)[\u0026#34;col1\u0026#34;].to_list() print(filtered_values) [2, 3] Get the dimension of the DataFrame df.shape (3, 2) Paste a text string to a range of numbers # Generate the sequence from 1001 to 1010 and concatenate \u0026#34;DK\u0026#34; with each value result = [f\u0026#34;DK{1000 + i}\u0026#34; for i in range(1, 11)] print(result) result = [\u0026#34;DK\u0026#34; + str(i) for i in range(1001, 1011)] print(result) [\u0026#39;DK1001\u0026#39;, \u0026#39;DK1002\u0026#39;, \u0026#39;DK1003\u0026#39;, \u0026#39;DK1004\u0026#39;, \u0026#39;DK1005\u0026#39;, \u0026#39;DK1006\u0026#39;, \u0026#39;DK1007\u0026#39;, \u0026#39;DK1008\u0026#39;, \u0026#39;DK1009\u0026#39;, \u0026#39;DK1010\u0026#39;]\r[\u0026#39;DK1001\u0026#39;, \u0026#39;DK1002\u0026#39;, \u0026#39;DK1003\u0026#39;, \u0026#39;DK1004\u0026#39;, \u0026#39;DK1005\u0026#39;, \u0026#39;DK1006\u0026#39;, \u0026#39;DK1007\u0026#39;, \u0026#39;DK1008\u0026#39;, \u0026#39;DK1009\u0026#39;, \u0026#39;DK1010\u0026#39;] Remove Initial characters in a string list string_list = [\u0026#34;AB123\u0026#34;, \u0026#34;CD456\u0026#34;, \u0026#34;EF789\u0026#34;, \u0026#34;GH012\u0026#34;] # Remove the first two characters from each string modified_list = [s[2:] for s in string_list] print(modified_list) [\u0026#39;123\u0026#39;, \u0026#39;456\u0026#39;, \u0026#39;789\u0026#39;, \u0026#39;012\u0026#39;] Copy a column into another when a condition is met df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40] }) # Copy \u0026#39;col2\u0026#39; to \u0026#39;col1\u0026#39; where \u0026#39;col1\u0026#39; starts with \u0026#39;GK\u0026#39; df = df.with_columns( pl.when(pl.col(\u0026#34;col1\u0026#34;).str.starts_with(\u0026#34;GK\u0026#34;)) .then(pl.col(\u0026#34;col2\u0026#34;)) # Copy \u0026#39;col2\u0026#39; value to \u0026#39;col1\u0026#39; .otherwise(pl.col(\u0026#34;col1\u0026#34;)) # Keep original \u0026#39;col1\u0026#39; value if condition is not met .alias(\u0026#34;col1\u0026#34;) ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ 10 ┆ 10 │\r│ AB456 ┆ 20 │\r│ 30 ┆ 30 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Copy a list into a DataFrame column when a condition is met df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40] }) new_values = [\u0026#34;XY987\u0026#34;, \u0026#34;ZW654\u0026#34;, \u0026#34;XY987\u0026#34;, \u0026#34;ZW654\u0026#34;] # Copy \u0026#39;new_values\u0026#39; to \u0026#39;col1\u0026#39; where \u0026#39;col1\u0026#39; starts with \u0026#39;GK\u0026#39; df = df.with_columns( pl.when(pl.col(\u0026#34;col1\u0026#34;).str.starts_with(\u0026#34;GK\u0026#34;)) .then(pl.Series(new_values)) # Assign new values with the same shape .otherwise(pl.col(\u0026#34;col1\u0026#34;)) .alias(\u0026#34;col1\u0026#34;) ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ AB456 ┆ 20 │\r│ XY987 ┆ 30 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Copy a list into a column df = df.with_columns(pl.Series(\u0026#34;col1\u0026#34;, new_values)) print(df) df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;GK123\u0026#34;, \u0026#34;AB456\u0026#34;, \u0026#34;GK789\u0026#34;, \u0026#34;CD012\u0026#34;], \u0026#34;col2\u0026#34;: [10, 20, 30, 40] }) df = df.with_columns(col1 = pl.lit(pl.Series(new_values))) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ ZW654 ┆ 20 │\r│ XY987 ┆ 30 │\r│ ZW654 ┆ 40 │\r└───────┴──────┘\rshape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ ZW654 ┆ 20 │\r│ XY987 ┆ 30 │\r│ ZW654 ┆ 40 │\r└───────┴──────┘ Copy row-sums (rowSums) of columns \u0026ldquo;a\u0026rdquo; and \u0026ldquo;b\u0026rdquo; into column \u0026ldquo;a\u0026rdquo; df = pl.DataFrame({ \u0026#34;a\u0026#34;: [1, 2, 3], \u0026#34;b\u0026#34;: [4, 5, 6] }) # Compute the row-wise sum of columns \u0026#34;a\u0026#34; and \u0026#34;b\u0026#34; and store it in column \u0026#34;a\u0026#34; df = df.with_columns( (pl.col(\u0026#34;a\u0026#34;) + pl.col(\u0026#34;b\u0026#34;)).alias(\u0026#34;a\u0026#34;) ) print(df) shape: (3, 2)\r┌─────┬─────┐\r│ a ┆ b │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞═════╪═════╡\r│ 5 ┆ 4 │\r│ 7 ┆ 5 │\r│ 9 ┆ 6 │\r└─────┴─────┘ Drop columns with the column name ending with a pattern df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2_right\u0026#34;: [4, 5, 6], \u0026#34;col3\u0026#34;: [7, 8, 9], \u0026#34;col4_right\u0026#34;: [10, 11, 12] }) # Drop columns that end with \u0026#34;_right\u0026#34; df = df.select([col for col in df.columns if not col.endswith(\u0026#34;_right\u0026#34;)]) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col3 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 1 ┆ 7 │\r│ 2 ┆ 8 │\r│ 3 ┆ 9 │\r└──────┴──────┘ Rename columns with the column name ending with a pattern df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2_right\u0026#34;: [4, 5, 6], \u0026#34;col3\u0026#34;: [7, 8, 9], \u0026#34;col4_right\u0026#34;: [10, 11, 12] }) # Rename columns ending with \u0026#34;_right\u0026#34; to \u0026#34;d*\u0026#34; (d1, d2, ...) new_names = {} counter = 1 for col in df.columns: if col.endswith(\u0026#34;_right\u0026#34;): new_names[col] = f\u0026#34;d{counter}\u0026#34; counter += 1 # Apply the renaming df = df.rename(new_names) print(df) df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2_right\u0026#34;: [4, 5, 6], \u0026#34;col3\u0026#34;: [7, 8, 9], \u0026#34;col4_right\u0026#34;: [10, 11, 12] }) # Create a dictionary to hold the renaming mappings new_names = {} # Iterate through the columns and rename those ending with \u0026#34;_right\u0026#34; for col in df.columns: if col.endswith(\u0026#34;_right\u0026#34;): # Extract the part before \u0026#34;_right\u0026#34; and prepend \u0026#34;d\u0026#34; base_name = col.split(\u0026#34;_right\u0026#34;)[0] new_names[col] = f\u0026#34;d{base_name}\u0026#34; # Apply the renaming df = df.rename(new_names) print(df) shape: (3, 4)\r┌──────┬─────┬──────┬─────┐\r│ col1 ┆ d1 ┆ col3 ┆ d2 │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪═════╪══════╪═════╡\r│ 1 ┆ 4 ┆ 7 ┆ 10 │\r│ 2 ┆ 5 ┆ 8 ┆ 11 │\r│ 3 ┆ 6 ┆ 9 ┆ 12 │\r└──────┴─────┴──────┴─────┘\rshape: (3, 4)\r┌──────┬───────┬──────┬───────┐\r│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪═══════╪══════╪═══════╡\r│ 1 ┆ 4 ┆ 7 ┆ 10 │\r│ 2 ┆ 5 ┆ 8 ┆ 11 │\r│ 3 ┆ 6 ┆ 9 ┆ 12 │\r└──────┴───────┴──────┴───────┘ Rename columns based on column index df = pl.DataFrame({ \u0026#34;original1\u0026#34;: [\u0026#34;123-456\u0026#34;, \u0026#34;789-012\u0026#34;, \u0026#34;345-678\u0026#34;], \u0026#34;original2\u0026#34;: [1, 2, 3], \u0026#34;original3\u0026#34;: [10, 20, 30] }) # Get the first two column names old_names = df.columns[:2] # New names for the first two columns new_names = [\u0026#34;col1\u0026#34;, \u0026#34;col2\u0026#34;] # Rename the first two columns df = df.rename({old_names[0]: new_names[0], old_names[1]: new_names[1]}) print(df) shape: (3, 3)\r┌─────────┬──────┬───────────┐\r│ col1 ┆ col2 ┆ original3 │\r│ --- ┆ --- ┆ --- │\r│ str ┆ i64 ┆ i64 │\r╞═════════╪══════╪═══════════╡\r│ 123-456 ┆ 1 ┆ 10 │\r│ 789-012 ┆ 2 ┆ 20 │\r│ 345-678 ┆ 3 ┆ 30 │\r└─────────┴──────┴───────────┘ Rename all columns with a list df = pl.DataFrame({ \u0026#34;old_name1\u0026#34;: [1, 2, 3], \u0026#34;old_name2\u0026#34;: [4, 5, 6], \u0026#34;old_name3\u0026#34;: [7, 8, 9] }) # List of new column names new_column_names = [\u0026#34;new_name1\u0026#34;, \u0026#34;new_name2\u0026#34;, \u0026#34;new_name3\u0026#34;] # Rename all columns df = df.rename({old: new for old, new in zip(df.columns, new_column_names)}) print(df) shape: (3, 3)\r┌───────────┬───────────┬───────────┐\r│ new_name1 ┆ new_name2 ┆ new_name3 │\r│ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 │\r╞═══════════╪═══════════╪═══════════╡\r│ 1 ┆ 4 ┆ 7 │\r│ 2 ┆ 5 ┆ 8 │\r│ 3 ┆ 6 ┆ 9 │\r└───────────┴───────────┴───────────┘ The difference between .str.replace and .str.replace_all df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;123-456-34\u0026#34;, \u0026#34;789-012-78\u0026#34;, \u0026#34;345-678-02\u0026#34;], \u0026#34;col2\u0026#34;: [1, 2, 3] }) # Replace \u0026#34;-\u0026#34; with \u0026#34;\u0026#34; in the \u0026#34;col1\u0026#34; column df = df.with_columns( pl.col(\u0026#34;col1\u0026#34;).str.replace(\u0026#34;-\u0026#34;, \u0026#34;\u0026#34;).alias(\u0026#34;col1\u0026#34;) ) print(df) df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;123-456\u0026#34;, \u0026#34;789-012\u0026#34;, \u0026#34;345-678\u0026#34;], \u0026#34;col2\u0026#34;: [1, 2, 3] }) # Replace \u0026#34;-\u0026#34; with \u0026#34;\u0026#34; in the \u0026#34;col1\u0026#34; column df = df.with_columns( pl.col(\u0026#34;col1\u0026#34;).str.replace_all(\u0026#34;-\u0026#34;, \u0026#34;\u0026#34;).alias(\u0026#34;col1\u0026#34;) ) print(df) shape: (3, 2)\r┌───────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════════╪══════╡\r│ 123456-34 ┆ 1 │\r│ 789012-78 ┆ 2 │\r│ 345678-02 ┆ 3 │\r└───────────┴──────┘\rshape: (3, 2)\r┌────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞════════╪══════╡\r│ 123456 ┆ 1 │\r│ 789012 ┆ 2 │\r│ 345678 ┆ 3 │\r└────────┴──────┘ Read specific columns from a CSV file # df = pl.read_csv(\u0026#34;data.csv\u0026#34;, columns=[0, 2]) Replace null with 0 in the last two columns df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2\u0026#34;: [None, 5, None], \u0026#34;col3\u0026#34;: [7, None, 9] }) # Replace null with 0 in the last two columns df = df.with_columns( [pl.col(df.columns[-2:]).fill_null(0)] ) print(df) shape: (3, 3)\r┌──────┬──────┬──────┐\r│ col1 ┆ col2 ┆ col3 │\r│ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╡\r│ 1 ┆ 0 ┆ 7 │\r│ 2 ┆ 5 ┆ 0 │\r│ 3 ┆ 0 ┆ 9 │\r└──────┴──────┴──────┘ Drop the first two characters from all elements in a DataFrame df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;ab123\u0026#34;, \u0026#34;ab456\u0026#34;, \u0026#34;ab789\u0026#34;], \u0026#34;col2\u0026#34;: [\u0026#34;cd001\u0026#34;, \u0026#34;cd002\u0026#34;, \u0026#34;cd003\u0026#34;] }) # Drop the first two characters from all elements in the DataFrame df = df.with_columns( [pl.col(c).str.slice(2) for c in df.columns] ) print(df) # Now, do the same, but turn the resulting elements into integers. df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;ab123\u0026#34;, \u0026#34;ab456\u0026#34;, \u0026#34;ab789\u0026#34;], \u0026#34;col2\u0026#34;: [\u0026#34;cd001\u0026#34;, \u0026#34;cd002\u0026#34;, \u0026#34;cd003\u0026#34;] }) # Drop the first two characters and convert the remaining strings to integers df = df.with_columns( [pl.col(c).str.slice(2).cast(pl.Int64) for c in df.columns] ) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ str │\r╞══════╪══════╡\r│ 123 ┆ 001 │\r│ 456 ┆ 002 │\r│ 789 ┆ 003 │\r└──────┴──────┘\rshape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 123 ┆ 1 │\r│ 456 ┆ 2 │\r│ 789 ┆ 3 │\r└──────┴──────┘ Drop a column by its index number df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2\u0026#34;: [4, 5, 6], \u0026#34;col3\u0026#34;: [7, 8, 9] }) # Drop the first column by its index (0) df = df.drop(df.columns[0]) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col2 ┆ col3 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 4 ┆ 7 │\r│ 5 ┆ 8 │\r│ 6 ┆ 9 │\r└──────┴──────┘ Reorder columns df.select([\u0026#39;col3\u0026#39;, \u0026#39;col2\u0026#39;]) shape: (3, 2)col3col2i64i64748596\rdf.select([pl.col(\u0026#39;col3\u0026#39;), pl.col(\u0026#39;col2\u0026#39;)]) shape: (3, 2)col3col2i64i64748596\rReorder DataFrame\u0026rsquo;s rows by matching a column with a list df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;a\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;d\u0026#34;], \u0026#34;col2\u0026#34;: [1, 2, 3, 4, 5] }) # The desired order for \u0026#34;col1\u0026#34; desired_order = [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;] # Reorder the DataFrame by matching \u0026#34;col1\u0026#34; with the desired_order list df_reordered = df.with_columns( pl.col(\u0026#34;col1\u0026#34;).map_elements(lambda x: desired_order.index(x), return_dtype=pl.Int64).alias(\u0026#34;sort_key\u0026#34;) ).sort(\u0026#34;sort_key\u0026#34;).drop(\u0026#34;sort_key\u0026#34;) print(df_reordered) # or df_reordered = df.join(pl.DataFrame({\u0026#34;col1\u0026#34;: desired_order}), on = \u0026#34;col1\u0026#34;) print(df_reordered) shape: (5, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞══════╪══════╡\r│ a ┆ 3 │\r│ b ┆ 1 │\r│ c ┆ 2 │\r│ d ┆ 5 │\r│ e ┆ 4 │\r└──────┴──────┘\rshape: (5, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞══════╪══════╡\r│ a ┆ 3 │\r│ b ┆ 1 │\r│ c ┆ 2 │\r│ d ┆ 5 │\r│ e ┆ 4 │\r└──────┴──────┘ Filter the DataFrame for elements containing a pattern in a column df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [\u0026#34;abc123\u0026#34;, \u0026#34;def456\u0026#34;, \u0026#34;ghi789\u0026#34;, \u0026#34;abcxyz\u0026#34;], \u0026#34;col2\u0026#34;: [1, 2, 3, 4] }) # Filter rows where \u0026#34;col1\u0026#34; contains the pattern \u0026#34;abc\u0026#34; filtered_df = df.filter(pl.col(\u0026#34;col1\u0026#34;).str.contains(\u0026#34;abc\u0026#34;)) print(filtered_df) shape: (2, 2)\r┌────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞════════╪══════╡\r│ abc123 ┆ 1 │\r│ abcxyz ┆ 4 │\r└────────┴──────┘ Compute the dot/inner product (crossproduct) between two Series s = pl.Series(\u0026#34;a\u0026#34;, [1, 2, 3]) s2 = pl.Series(\u0026#34;b\u0026#34;, [4.0, 5.0, 6.0]) s.dot(s2) 32.0 Extract rows of a DataFrame in a list of tuples print(df.rows()) [(\u0026#39;abc123\u0026#39;, 1), (\u0026#39;def456\u0026#39;, 2), (\u0026#39;ghi789\u0026#39;, 3), (\u0026#39;abcxyz\u0026#39;, 4)] Get rowSums of a DataFrame df = pl.DataFrame({ \u0026#34;col1\u0026#34;: [1, 2, 3], \u0026#34;col2\u0026#34;: [4, 5, 6], \u0026#34;col3\u0026#34;: [7, 8, 9] }) df = df.with_columns(df.select(pl.sum_horizontal(\u0026#34;*\u0026#34;).alias(\u0026#34;row_sum\u0026#34;))) df.with_columns(df.select(pl.sum_horizontal([\u0026#34;col1\u0026#34;,\u0026#34;col2\u0026#34;]).alias(\u0026#34;row_sum\u0026#34;))) print(df) shape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘ head and tail print(df.head()) print(df.head(2)) print(df.tail()) print(df.tail(2)) shape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘\rshape: (2, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r└──────┴──────┴──────┴─────────┘\rshape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘\rshape: (2, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘ Matrix-vector multiplication import numpy as np a = pl.DataFrame({ \u0026#34;col1\u0026#34;: [5,1,3,2], \u0026#34;col2\u0026#34;: [1,1,1,3], \u0026#34;col3\u0026#34;: [1,2,1,4] }) b = [1, 2, 3] print(a.to_numpy().dot(b)) [10 9 8 20] ",
  "keywords": [
    "python"
  ],
  "articleBody": "Most of these commands are derived with the help of ChatGPT or stackoverflow. However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.\nThere might be a few Python examples here not directly related to Polars!\nRead . as missing value import polars as pl # df = pl.read_csv(\"your_file.csv\", null_values=\".\", has_header = True) Replace . with missing value df = pl.DataFrame({ \"col1\": [\".\", \"AB456\", \"GK789\", \".\"], \"col2\": [10, 20, 30, 40], \"col3\": [1, 2, 3, 4] }) df = df.with_columns(pl.col(pl.String).replace({\".\": None})) print(df) shape: (4, 3)\r┌───────┬──────┬──────┐\r│ col1 ┆ col2 ┆ col3 │\r│ --- ┆ --- ┆ --- │\r│ str ┆ i64 ┆ i64 │\r╞═══════╪══════╪══════╡\r│ null ┆ 10 ┆ 1 │\r│ AB456 ┆ 20 ┆ 2 │\r│ GK789 ┆ 30 ┆ 3 │\r│ null ┆ 40 ┆ 4 │\r└───────┴──────┴──────┘ Get column names df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 20, 30, 40], \"col3\": [1, 2, 3, 4] }) print(df.columns) # Get the last two columns print(df.columns[-2:]) # Get the first two columns print(df.columns[:2]) ['col1', 'col2', 'col3']\r['col2', 'col3']\r['col1', 'col2'] Change values in a column based on a condition in another column df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 20, 30, 40] }) # Replace values in 'col2' based on the condition that 'col1' starts with 'GK' df = df.with_columns( pl.when(pl.col(\"col1\").str.starts_with(\"GK\")) .then(999) # Replace with your desired value .otherwise(pl.col(\"col2\")) # Keep original value if condition is not met .alias(\"col2\") ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 999 │\r│ AB456 ┆ 20 │\r│ GK789 ┆ 999 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Change values in a column based on multiple conditions in another column df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 25, 30, 40] }) # Replace values in 'col2' based on multiple conditions df = df.with_columns( pl.when((pl.col(\"col1\").str.starts_with(\"GK\")) \u0026 (pl.col(\"col2\") \u003e 20)) .then(999) # Replace with your desired value .otherwise(pl.col(\"col2\")) # Keep original value if conditions are not met .alias(\"col2\") ) print(df) df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 25, 30, 40] }) df = df.with_columns( pl.when(pl.col(\"col2\") \u003c 11).then(20) .when(pl.col(\"col2\") \u003e 33).then(pl.col(\"col2\") * 2) .otherwise(pl.col(\"col2\")) .alias(\"col2\") ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 10 │\r│ AB456 ┆ 25 │\r│ GK789 ┆ 999 │\r│ CD012 ┆ 40 │\r└───────┴──────┘\rshape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ GK123 ┆ 20 │\r│ AB456 ┆ 25 │\r│ GK789 ┆ 30 │\r│ CD012 ┆ 80 │\r└───────┴──────┘ Extract a column into a vector col1_vector = df[\"col1\"].to_list() print(col1_vector) ['GK123', 'AB456', 'GK789', 'CD012'] Extract values meeting a condition from a column df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2\": [4, 5, 6] }) # Extract values from 'col1' that are greater than 1 filtered_values = df.filter(pl.col(\"col1\") \u003e 1)[\"col1\"].to_list() print(filtered_values) [2, 3] Get the dimension of the DataFrame df.shape (3, 2) Paste a text string to a range of numbers # Generate the sequence from 1001 to 1010 and concatenate \"DK\" with each value result = [f\"DK{1000 + i}\" for i in range(1, 11)] print(result) result = [\"DK\" + str(i) for i in range(1001, 1011)] print(result) ['DK1001', 'DK1002', 'DK1003', 'DK1004', 'DK1005', 'DK1006', 'DK1007', 'DK1008', 'DK1009', 'DK1010']\r['DK1001', 'DK1002', 'DK1003', 'DK1004', 'DK1005', 'DK1006', 'DK1007', 'DK1008', 'DK1009', 'DK1010'] Remove Initial characters in a string list string_list = [\"AB123\", \"CD456\", \"EF789\", \"GH012\"] # Remove the first two characters from each string modified_list = [s[2:] for s in string_list] print(modified_list) ['123', '456', '789', '012'] Copy a column into another when a condition is met df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 20, 30, 40] }) # Copy 'col2' to 'col1' where 'col1' starts with 'GK' df = df.with_columns( pl.when(pl.col(\"col1\").str.starts_with(\"GK\")) .then(pl.col(\"col2\")) # Copy 'col2' value to 'col1' .otherwise(pl.col(\"col1\")) # Keep original 'col1' value if condition is not met .alias(\"col1\") ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ 10 ┆ 10 │\r│ AB456 ┆ 20 │\r│ 30 ┆ 30 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Copy a list into a DataFrame column when a condition is met df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 20, 30, 40] }) new_values = [\"XY987\", \"ZW654\", \"XY987\", \"ZW654\"] # Copy 'new_values' to 'col1' where 'col1' starts with 'GK' df = df.with_columns( pl.when(pl.col(\"col1\").str.starts_with(\"GK\")) .then(pl.Series(new_values)) # Assign new values with the same shape .otherwise(pl.col(\"col1\")) .alias(\"col1\") ) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ AB456 ┆ 20 │\r│ XY987 ┆ 30 │\r│ CD012 ┆ 40 │\r└───────┴──────┘ Copy a list into a column df = df.with_columns(pl.Series(\"col1\", new_values)) print(df) df = pl.DataFrame({ \"col1\": [\"GK123\", \"AB456\", \"GK789\", \"CD012\"], \"col2\": [10, 20, 30, 40] }) df = df.with_columns(col1 = pl.lit(pl.Series(new_values))) print(df) shape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ ZW654 ┆ 20 │\r│ XY987 ┆ 30 │\r│ ZW654 ┆ 40 │\r└───────┴──────┘\rshape: (4, 2)\r┌───────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════╪══════╡\r│ XY987 ┆ 10 │\r│ ZW654 ┆ 20 │\r│ XY987 ┆ 30 │\r│ ZW654 ┆ 40 │\r└───────┴──────┘ Copy row-sums (rowSums) of columns “a” and “b” into column “a” df = pl.DataFrame({ \"a\": [1, 2, 3], \"b\": [4, 5, 6] }) # Compute the row-wise sum of columns \"a\" and \"b\" and store it in column \"a\" df = df.with_columns( (pl.col(\"a\") + pl.col(\"b\")).alias(\"a\") ) print(df) shape: (3, 2)\r┌─────┬─────┐\r│ a ┆ b │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞═════╪═════╡\r│ 5 ┆ 4 │\r│ 7 ┆ 5 │\r│ 9 ┆ 6 │\r└─────┴─────┘ Drop columns with the column name ending with a pattern df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2_right\": [4, 5, 6], \"col3\": [7, 8, 9], \"col4_right\": [10, 11, 12] }) # Drop columns that end with \"_right\" df = df.select([col for col in df.columns if not col.endswith(\"_right\")]) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col3 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 1 ┆ 7 │\r│ 2 ┆ 8 │\r│ 3 ┆ 9 │\r└──────┴──────┘ Rename columns with the column name ending with a pattern df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2_right\": [4, 5, 6], \"col3\": [7, 8, 9], \"col4_right\": [10, 11, 12] }) # Rename columns ending with \"_right\" to \"d*\" (d1, d2, ...) new_names = {} counter = 1 for col in df.columns: if col.endswith(\"_right\"): new_names[col] = f\"d{counter}\" counter += 1 # Apply the renaming df = df.rename(new_names) print(df) df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2_right\": [4, 5, 6], \"col3\": [7, 8, 9], \"col4_right\": [10, 11, 12] }) # Create a dictionary to hold the renaming mappings new_names = {} # Iterate through the columns and rename those ending with \"_right\" for col in df.columns: if col.endswith(\"_right\"): # Extract the part before \"_right\" and prepend \"d\" base_name = col.split(\"_right\")[0] new_names[col] = f\"d{base_name}\" # Apply the renaming df = df.rename(new_names) print(df) shape: (3, 4)\r┌──────┬─────┬──────┬─────┐\r│ col1 ┆ d1 ┆ col3 ┆ d2 │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪═════╪══════╪═════╡\r│ 1 ┆ 4 ┆ 7 ┆ 10 │\r│ 2 ┆ 5 ┆ 8 ┆ 11 │\r│ 3 ┆ 6 ┆ 9 ┆ 12 │\r└──────┴─────┴──────┴─────┘\rshape: (3, 4)\r┌──────┬───────┬──────┬───────┐\r│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪═══════╪══════╪═══════╡\r│ 1 ┆ 4 ┆ 7 ┆ 10 │\r│ 2 ┆ 5 ┆ 8 ┆ 11 │\r│ 3 ┆ 6 ┆ 9 ┆ 12 │\r└──────┴───────┴──────┴───────┘ Rename columns based on column index df = pl.DataFrame({ \"original1\": [\"123-456\", \"789-012\", \"345-678\"], \"original2\": [1, 2, 3], \"original3\": [10, 20, 30] }) # Get the first two column names old_names = df.columns[:2] # New names for the first two columns new_names = [\"col1\", \"col2\"] # Rename the first two columns df = df.rename({old_names[0]: new_names[0], old_names[1]: new_names[1]}) print(df) shape: (3, 3)\r┌─────────┬──────┬───────────┐\r│ col1 ┆ col2 ┆ original3 │\r│ --- ┆ --- ┆ --- │\r│ str ┆ i64 ┆ i64 │\r╞═════════╪══════╪═══════════╡\r│ 123-456 ┆ 1 ┆ 10 │\r│ 789-012 ┆ 2 ┆ 20 │\r│ 345-678 ┆ 3 ┆ 30 │\r└─────────┴──────┴───────────┘ Rename all columns with a list df = pl.DataFrame({ \"old_name1\": [1, 2, 3], \"old_name2\": [4, 5, 6], \"old_name3\": [7, 8, 9] }) # List of new column names new_column_names = [\"new_name1\", \"new_name2\", \"new_name3\"] # Rename all columns df = df.rename({old: new for old, new in zip(df.columns, new_column_names)}) print(df) shape: (3, 3)\r┌───────────┬───────────┬───────────┐\r│ new_name1 ┆ new_name2 ┆ new_name3 │\r│ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 │\r╞═══════════╪═══════════╪═══════════╡\r│ 1 ┆ 4 ┆ 7 │\r│ 2 ┆ 5 ┆ 8 │\r│ 3 ┆ 6 ┆ 9 │\r└───────────┴───────────┴───────────┘ The difference between .str.replace and .str.replace_all df = pl.DataFrame({ \"col1\": [\"123-456-34\", \"789-012-78\", \"345-678-02\"], \"col2\": [1, 2, 3] }) # Replace \"-\" with \"\" in the \"col1\" column df = df.with_columns( pl.col(\"col1\").str.replace(\"-\", \"\").alias(\"col1\") ) print(df) df = pl.DataFrame({ \"col1\": [\"123-456\", \"789-012\", \"345-678\"], \"col2\": [1, 2, 3] }) # Replace \"-\" with \"\" in the \"col1\" column df = df.with_columns( pl.col(\"col1\").str.replace_all(\"-\", \"\").alias(\"col1\") ) print(df) shape: (3, 2)\r┌───────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞═══════════╪══════╡\r│ 123456-34 ┆ 1 │\r│ 789012-78 ┆ 2 │\r│ 345678-02 ┆ 3 │\r└───────────┴──────┘\rshape: (3, 2)\r┌────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞════════╪══════╡\r│ 123456 ┆ 1 │\r│ 789012 ┆ 2 │\r│ 345678 ┆ 3 │\r└────────┴──────┘ Read specific columns from a CSV file # df = pl.read_csv(\"data.csv\", columns=[0, 2]) Replace null with 0 in the last two columns df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2\": [None, 5, None], \"col3\": [7, None, 9] }) # Replace null with 0 in the last two columns df = df.with_columns( [pl.col(df.columns[-2:]).fill_null(0)] ) print(df) shape: (3, 3)\r┌──────┬──────┬──────┐\r│ col1 ┆ col2 ┆ col3 │\r│ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╡\r│ 1 ┆ 0 ┆ 7 │\r│ 2 ┆ 5 ┆ 0 │\r│ 3 ┆ 0 ┆ 9 │\r└──────┴──────┴──────┘ Drop the first two characters from all elements in a DataFrame df = pl.DataFrame({ \"col1\": [\"ab123\", \"ab456\", \"ab789\"], \"col2\": [\"cd001\", \"cd002\", \"cd003\"] }) # Drop the first two characters from all elements in the DataFrame df = df.with_columns( [pl.col(c).str.slice(2) for c in df.columns] ) print(df) # Now, do the same, but turn the resulting elements into integers. df = pl.DataFrame({ \"col1\": [\"ab123\", \"ab456\", \"ab789\"], \"col2\": [\"cd001\", \"cd002\", \"cd003\"] }) # Drop the first two characters and convert the remaining strings to integers df = df.with_columns( [pl.col(c).str.slice(2).cast(pl.Int64) for c in df.columns] ) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ str │\r╞══════╪══════╡\r│ 123 ┆ 001 │\r│ 456 ┆ 002 │\r│ 789 ┆ 003 │\r└──────┴──────┘\rshape: (3, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 123 ┆ 1 │\r│ 456 ┆ 2 │\r│ 789 ┆ 3 │\r└──────┴──────┘ Drop a column by its index number df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2\": [4, 5, 6], \"col3\": [7, 8, 9] }) # Drop the first column by its index (0) df = df.drop(df.columns[0]) print(df) shape: (3, 2)\r┌──────┬──────┐\r│ col2 ┆ col3 │\r│ --- ┆ --- │\r│ i64 ┆ i64 │\r╞══════╪══════╡\r│ 4 ┆ 7 │\r│ 5 ┆ 8 │\r│ 6 ┆ 9 │\r└──────┴──────┘ Reorder columns df.select(['col3', 'col2']) shape: (3, 2)col3col2i64i64748596\rdf.select([pl.col('col3'), pl.col('col2')]) shape: (3, 2)col3col2i64i64748596\rReorder DataFrame’s rows by matching a column with a list df = pl.DataFrame({ \"col1\": [\"b\", \"c\", \"a\", \"e\", \"d\"], \"col2\": [1, 2, 3, 4, 5] }) # The desired order for \"col1\" desired_order = [\"a\", \"b\", \"c\", \"d\", \"e\"] # Reorder the DataFrame by matching \"col1\" with the desired_order list df_reordered = df.with_columns( pl.col(\"col1\").map_elements(lambda x: desired_order.index(x), return_dtype=pl.Int64).alias(\"sort_key\") ).sort(\"sort_key\").drop(\"sort_key\") print(df_reordered) # or df_reordered = df.join(pl.DataFrame({\"col1\": desired_order}), on = \"col1\") print(df_reordered) shape: (5, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞══════╪══════╡\r│ a ┆ 3 │\r│ b ┆ 1 │\r│ c ┆ 2 │\r│ d ┆ 5 │\r│ e ┆ 4 │\r└──────┴──────┘\rshape: (5, 2)\r┌──────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞══════╪══════╡\r│ a ┆ 3 │\r│ b ┆ 1 │\r│ c ┆ 2 │\r│ d ┆ 5 │\r│ e ┆ 4 │\r└──────┴──────┘ Filter the DataFrame for elements containing a pattern in a column df = pl.DataFrame({ \"col1\": [\"abc123\", \"def456\", \"ghi789\", \"abcxyz\"], \"col2\": [1, 2, 3, 4] }) # Filter rows where \"col1\" contains the pattern \"abc\" filtered_df = df.filter(pl.col(\"col1\").str.contains(\"abc\")) print(filtered_df) shape: (2, 2)\r┌────────┬──────┐\r│ col1 ┆ col2 │\r│ --- ┆ --- │\r│ str ┆ i64 │\r╞════════╪══════╡\r│ abc123 ┆ 1 │\r│ abcxyz ┆ 4 │\r└────────┴──────┘ Compute the dot/inner product (crossproduct) between two Series s = pl.Series(\"a\", [1, 2, 3]) s2 = pl.Series(\"b\", [4.0, 5.0, 6.0]) s.dot(s2) 32.0 Extract rows of a DataFrame in a list of tuples print(df.rows()) [('abc123', 1), ('def456', 2), ('ghi789', 3), ('abcxyz', 4)] Get rowSums of a DataFrame df = pl.DataFrame({ \"col1\": [1, 2, 3], \"col2\": [4, 5, 6], \"col3\": [7, 8, 9] }) df = df.with_columns(df.select(pl.sum_horizontal(\"*\").alias(\"row_sum\"))) df.with_columns(df.select(pl.sum_horizontal([\"col1\",\"col2\"]).alias(\"row_sum\"))) print(df) shape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘ head and tail print(df.head()) print(df.head(2)) print(df.tail()) print(df.tail(2)) shape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘\rshape: (2, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r└──────┴──────┴──────┴─────────┘\rshape: (3, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 1 ┆ 4 ┆ 7 ┆ 12 │\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘\rshape: (2, 4)\r┌──────┬──────┬──────┬─────────┐\r│ col1 ┆ col2 ┆ col3 ┆ row_sum │\r│ --- ┆ --- ┆ --- ┆ --- │\r│ i64 ┆ i64 ┆ i64 ┆ i64 │\r╞══════╪══════╪══════╪═════════╡\r│ 2 ┆ 5 ┆ 8 ┆ 15 │\r│ 3 ┆ 6 ┆ 9 ┆ 18 │\r└──────┴──────┴──────┴─────────┘ Matrix-vector multiplication import numpy as np a = pl.DataFrame({ \"col1\": [5,1,3,2], \"col2\": [1,1,1,3], \"col3\": [1,2,1,4] }) b = [1, 2, 3] print(a.to_numpy().dot(b)) [10 9 8 20] ",
  "wordCount" : "2669",
  "inLanguage": "en",
  "image": "https://nilforooshan.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished": "2024-10-25T00:00:00Z",
  "dateModified": "2024-10-25T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mohammad Ali Nilforooshan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://nilforooshan.github.io/blog/posts/polars-tutorial2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mohammad Ali Nilforooshan",
    "logo": {
      "@type": "ImageObject",
      "url": "https://nilforooshan.github.io/blog/favicon.ico"
    }
  }
}
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            {left: "\\begin{equation}", right: "\\end{equation}", display: true},
            {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
            {left: "\\begin{align}", right: "\\end{align}", display: true},
            {left: "\\begin{align*}", right: "\\end{align*}", display: true},
            {left: "\\begin{alignat}", right: "\\end{alignat}", display: true},
            {left: "\\begin{gather}", right: "\\end{gather}", display: true},
            {left: "\\begin{CD}", right: "\\end{CD}", display: true},
          ],
          throwOnError : false
        });
    });
</script>


    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JH0F7W96MC"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-JH0F7W96MC');
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://nilforooshan.github.io/blog/" accesskey="h" title="Mohammad Ali Nilforooshan (Alt + H)">Mohammad Ali Nilforooshan</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://nilforooshan.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://nilforooshan.github.io/blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://nilforooshan.github.io/blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://nilforooshan.github.io/" title="My website">
                    <span>My website</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Polars Tutorial2
    </h1>
    <div class="post-meta"><span title='2024-10-25 00:00:00 +0000 UTC'>October 25, 2024</span>&nbsp;·&nbsp;Mohammad Ali Nilforooshan

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#read--as-missing-value" aria-label="Read . as missing value">Read . as missing value</a></li>
                <li>
                    <a href="#replace--with-missing-value" aria-label="Replace . with missing value">Replace . with missing value</a></li>
                <li>
                    <a href="#get-column-names" aria-label="Get column names">Get column names</a></li>
                <li>
                    <a href="#change-values-in-a-column-based-on-a-condition-in-another-column" aria-label="Change values in a column based on a condition in another column">Change values in a column based on a condition in another column</a></li>
                <li>
                    <a href="#change-values-in-a-column-based-on-multiple-conditions-in-another-column" aria-label="Change values in a column based on multiple conditions in another column">Change values in a column based on multiple conditions in another column</a></li>
                <li>
                    <a href="#extract-a-column-into-a-vector" aria-label="Extract a column into a vector">Extract a column into a vector</a></li>
                <li>
                    <a href="#extract-values-meeting-a-condition-from-a-column" aria-label="Extract values meeting a condition from a column">Extract values meeting a condition from a column</a></li>
                <li>
                    <a href="#get-the-dimension-of-the-dataframe" aria-label="Get the dimension of the DataFrame">Get the dimension of the DataFrame</a></li>
                <li>
                    <a href="#paste-a-text-string-to-a-range-of-numbers" aria-label="Paste a text string to a range of numbers">Paste a text string to a range of numbers</a></li>
                <li>
                    <a href="#remove-initial-characters-in-a-string-list" aria-label="Remove Initial characters in a string list">Remove Initial characters in a string list</a></li>
                <li>
                    <a href="#copy-a-column-into-another-when-a-condition-is-met" aria-label="Copy a column into another when a condition is met">Copy a column into another when a condition is met</a></li>
                <li>
                    <a href="#copy-a-list-into-a-dataframe-column-when-a-condition-is-met" aria-label="Copy a list into a DataFrame column when a condition is met">Copy a list into a DataFrame column when a condition is met</a></li>
                <li>
                    <a href="#copy-a-list-into-a-column" aria-label="Copy a list into a column">Copy a list into a column</a></li>
                <li>
                    <a href="#copy-row-sums-rowsums-of-columns-a-and-b-into-column-a" aria-label="Copy row-sums (rowSums) of columns &ldquo;a&rdquo; and &ldquo;b&rdquo; into column &ldquo;a&rdquo;">Copy row-sums (rowSums) of columns &ldquo;a&rdquo; and &ldquo;b&rdquo; into column &ldquo;a&rdquo;</a></li>
                <li>
                    <a href="#drop-columns-with-the-column-name-ending-with-a-pattern" aria-label="Drop columns with the column name ending with a pattern">Drop columns with the column name ending with a pattern</a></li>
                <li>
                    <a href="#rename-columns-with-the-column-name-ending-with-a-pattern" aria-label="Rename columns with the column name ending with a pattern">Rename columns with the column name ending with a pattern</a></li>
                <li>
                    <a href="#rename-columns-based-on-column-index" aria-label="Rename columns based on column index">Rename columns based on column index</a></li>
                <li>
                    <a href="#rename-all-columns-with-a-list" aria-label="Rename all columns with a list">Rename all columns with a list</a></li>
                <li>
                    <a href="#the-difference-between-strreplace-and-strreplace_all" aria-label="The difference between .str.replace and .str.replace_all">The difference between .str.replace and .str.replace_all</a></li>
                <li>
                    <a href="#read-specific-columns-from-a-csv-file" aria-label="Read specific columns from a CSV file">Read specific columns from a CSV file</a></li>
                <li>
                    <a href="#replace-null-with-0-in-the-last-two-columns" aria-label="Replace null with 0 in the last two columns">Replace null with 0 in the last two columns</a></li>
                <li>
                    <a href="#drop-the-first-two-characters-from-all-elements-in-a-dataframe" aria-label="Drop the first two characters from all elements in a DataFrame">Drop the first two characters from all elements in a DataFrame</a></li>
                <li>
                    <a href="#drop-a-column-by-its-index-number" aria-label="Drop a column by its index number">Drop a column by its index number</a></li>
                <li>
                    <a href="#reorder-columns" aria-label="Reorder columns">Reorder columns</a></li>
                <li>
                    <a href="#reorder-dataframes-rows-by-matching-a-column-with-a-list" aria-label="Reorder DataFrame&rsquo;s rows by matching a column with a list">Reorder DataFrame&rsquo;s rows by matching a column with a list</a></li>
                <li>
                    <a href="#filter-the-dataframe-for-elements-containing-a-pattern-in-a-column" aria-label="Filter the DataFrame for elements containing a pattern in a column">Filter the DataFrame for elements containing a pattern in a column</a></li>
                <li>
                    <a href="#compute-the-dotinner-product-crossproduct-between-two-series" aria-label="Compute the dot/inner product (crossproduct) between two Series">Compute the dot/inner product (crossproduct) between two Series</a></li>
                <li>
                    <a href="#extract-rows-of-a-dataframe-in-a-list-of-tuples" aria-label="Extract rows of a DataFrame in a list of tuples">Extract rows of a DataFrame in a list of tuples</a></li>
                <li>
                    <a href="#get-rowsums-of-a-dataframe" aria-label="Get rowSums of a DataFrame">Get rowSums of a DataFrame</a></li>
                <li>
                    <a href="#head-and-tail" aria-label="head and tail">head and tail</a></li>
                <li>
                    <a href="#matrix-vector-multiplication" aria-label="Matrix-vector multiplication">Matrix-vector multiplication</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Most of these commands are derived with the help of ChatGPT or stackoverflow.
However, it is easier to look for a command here rather than searching for the answers to these questions over and over again.</p>
<p>There might be a few Python examples here not directly related to Polars!</p>
<h2 id="read--as-missing-value">Read <code>.</code> as missing value<a hidden class="anchor" aria-hidden="true" href="#read--as-missing-value">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> polars <span style="color:#66d9ef">as</span> pl
</span></span><span style="display:flex;"><span><span style="color:#75715e"># df = pl.read_csv(&#34;your_file.csv&#34;, null_values=&#34;.&#34;, has_header = True)</span>
</span></span></code></pre></div><h2 id="replace--with-missing-value">Replace <code>.</code> with missing value<a hidden class="anchor" aria-hidden="true" href="#replace--with-missing-value">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;.&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(pl<span style="color:#f92672">.</span>col(pl<span style="color:#f92672">.</span>String)<span style="color:#f92672">.</span>replace({<span style="color:#e6db74">&#34;.&#34;</span>: <span style="color:#66d9ef">None</span>}))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 3)
┌───────┬──────┬──────┐
│ col1  ┆ col2 ┆ col3 │
│ ---   ┆ ---  ┆ ---  │
│ str   ┆ i64  ┆ i64  │
╞═══════╪══════╪══════╡
│ null  ┆ 10   ┆ 1    │
│ AB456 ┆ 20   ┆ 2    │
│ GK789 ┆ 30   ┆ 3    │
│ null  ┆ 40   ┆ 4    │
└───────┴──────┴──────┘
</code></pre><h2 id="get-column-names">Get column names<a hidden class="anchor" aria-hidden="true" href="#get-column-names">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>columns)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the last two columns</span>
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>columns[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the first two columns</span>
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>columns[:<span style="color:#ae81ff">2</span>])
</span></span></code></pre></div><pre tabindex="0"><code>[&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;]
[&#39;col2&#39;, &#39;col3&#39;]
[&#39;col1&#39;, &#39;col2&#39;]
</code></pre><h2 id="change-values-in-a-column-based-on-a-condition-in-another-column">Change values in a column based on a condition in another column<a hidden class="anchor" aria-hidden="true" href="#change-values-in-a-column-based-on-a-condition-in-another-column">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace values in &#39;col2&#39; based on the condition that &#39;col1&#39; starts with &#39;GK&#39;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>when(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>starts_with(<span style="color:#e6db74">&#34;GK&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>then(<span style="color:#ae81ff">999</span>)  <span style="color:#75715e"># Replace with your desired value</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>otherwise(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>))  <span style="color:#75715e"># Keep original value if condition is not met</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col2&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 999  │
│ AB456 ┆ 20   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
</code></pre><h2 id="change-values-in-a-column-based-on-multiple-conditions-in-another-column">Change values in a column based on multiple conditions in another column<a hidden class="anchor" aria-hidden="true" href="#change-values-in-a-column-based-on-multiple-conditions-in-another-column">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace values in &#39;col2&#39; based on multiple conditions</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>when((pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>starts_with(<span style="color:#e6db74">&#34;GK&#34;</span>)) <span style="color:#f92672">&amp;</span> (pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">20</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>then(<span style="color:#ae81ff">999</span>)  <span style="color:#75715e"># Replace with your desired value</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>otherwise(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>))  <span style="color:#75715e"># Keep original value if conditions are not met</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col2&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>when(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">11</span>)<span style="color:#f92672">.</span>then(<span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>when(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">33</span>)<span style="color:#f92672">.</span>then(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>otherwise(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col2&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 10   │
│ AB456 ┆ 25   │
│ GK789 ┆ 999  │
│ CD012 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ GK123 ┆ 20   │
│ AB456 ┆ 25   │
│ GK789 ┆ 30   │
│ CD012 ┆ 80   │
└───────┴──────┘
</code></pre><h2 id="extract-a-column-into-a-vector">Extract a column into a vector<a hidden class="anchor" aria-hidden="true" href="#extract-a-column-into-a-vector">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>col1_vector <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;col1&#34;</span>]<span style="color:#f92672">.</span>to_list()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(col1_vector)
</span></span></code></pre></div><pre tabindex="0"><code>[&#39;GK123&#39;, &#39;AB456&#39;, &#39;GK789&#39;, &#39;CD012&#39;]
</code></pre><h2 id="extract-values-meeting-a-condition-from-a-column">Extract values meeting a condition from a column<a hidden class="anchor" aria-hidden="true" href="#extract-values-meeting-a-condition-from-a-column">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Extract values from &#39;col1&#39; that are greater than 1</span>
</span></span><span style="display:flex;"><span>filtered_values <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>filter(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>)[<span style="color:#e6db74">&#34;col1&#34;</span>]<span style="color:#f92672">.</span>to_list()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(filtered_values)
</span></span></code></pre></div><pre tabindex="0"><code>[2, 3]
</code></pre><h2 id="get-the-dimension-of-the-dataframe">Get the dimension of the DataFrame<a hidden class="anchor" aria-hidden="true" href="#get-the-dimension-of-the-dataframe">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre tabindex="0"><code>(3, 2)
</code></pre><h2 id="paste-a-text-string-to-a-range-of-numbers">Paste a text string to a range of numbers<a hidden class="anchor" aria-hidden="true" href="#paste-a-text-string-to-a-range-of-numbers">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># Generate the sequence from 1001 to 1010 and concatenate &#34;DK&#34; with each value</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> [<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;DK</span><span style="color:#e6db74">{</span><span style="color:#ae81ff">1000</span> <span style="color:#f92672">+</span> i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;DK&#34;</span> <span style="color:#f92672">+</span> str(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1001</span>, <span style="color:#ae81ff">1011</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(result)
</span></span></code></pre></div><pre tabindex="0"><code>[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
[&#39;DK1001&#39;, &#39;DK1002&#39;, &#39;DK1003&#39;, &#39;DK1004&#39;, &#39;DK1005&#39;, &#39;DK1006&#39;, &#39;DK1007&#39;, &#39;DK1008&#39;, &#39;DK1009&#39;, &#39;DK1010&#39;]
</code></pre><h2 id="remove-initial-characters-in-a-string-list">Remove Initial characters in a string list<a hidden class="anchor" aria-hidden="true" href="#remove-initial-characters-in-a-string-list">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>string_list <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;AB123&#34;</span>, <span style="color:#e6db74">&#34;CD456&#34;</span>, <span style="color:#e6db74">&#34;EF789&#34;</span>, <span style="color:#e6db74">&#34;GH012&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Remove the first two characters from each string</span>
</span></span><span style="display:flex;"><span>modified_list <span style="color:#f92672">=</span> [s[<span style="color:#ae81ff">2</span>:] <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> string_list]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(modified_list)
</span></span></code></pre></div><pre tabindex="0"><code>[&#39;123&#39;, &#39;456&#39;, &#39;789&#39;, &#39;012&#39;]
</code></pre><h2 id="copy-a-column-into-another-when-a-condition-is-met">Copy a column into another when a condition is met<a hidden class="anchor" aria-hidden="true" href="#copy-a-column-into-another-when-a-condition-is-met">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Copy &#39;col2&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>when(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>starts_with(<span style="color:#e6db74">&#34;GK&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>then(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col2&#34;</span>))  <span style="color:#75715e"># Copy &#39;col2&#39; value to &#39;col1&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>otherwise(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>))  <span style="color:#75715e"># Keep original &#39;col1&#39; value if condition is not met</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col1&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ 10    ┆ 10   │
│ AB456 ┆ 20   │
│ 30    ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
</code></pre><h2 id="copy-a-list-into-a-dataframe-column-when-a-condition-is-met">Copy a list into a DataFrame column when a condition is met<a hidden class="anchor" aria-hidden="true" href="#copy-a-list-into-a-dataframe-column-when-a-condition-is-met">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>new_values <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;XY987&#34;</span>, <span style="color:#e6db74">&#34;ZW654&#34;</span>, <span style="color:#e6db74">&#34;XY987&#34;</span>, <span style="color:#e6db74">&#34;ZW654&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Copy &#39;new_values&#39; to &#39;col1&#39; where &#39;col1&#39; starts with &#39;GK&#39;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>when(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>starts_with(<span style="color:#e6db74">&#34;GK&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>then(pl<span style="color:#f92672">.</span>Series(new_values))  <span style="color:#75715e"># Assign new values with the same shape</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>otherwise(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col1&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ AB456 ┆ 20   │
│ XY987 ┆ 30   │
│ CD012 ┆ 40   │
└───────┴──────┘
</code></pre><h2 id="copy-a-list-into-a-column">Copy a list into a column<a hidden class="anchor" aria-hidden="true" href="#copy-a-list-into-a-column">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(pl<span style="color:#f92672">.</span>Series(<span style="color:#e6db74">&#34;col1&#34;</span>, new_values))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;GK123&#34;</span>, <span style="color:#e6db74">&#34;AB456&#34;</span>, <span style="color:#e6db74">&#34;GK789&#34;</span>, <span style="color:#e6db74">&#34;CD012&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(col1 <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>lit(pl<span style="color:#f92672">.</span>Series(new_values)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
shape: (4, 2)
┌───────┬──────┐
│ col1  ┆ col2 │
│ ---   ┆ ---  │
│ str   ┆ i64  │
╞═══════╪══════╡
│ XY987 ┆ 10   │
│ ZW654 ┆ 20   │
│ XY987 ┆ 30   │
│ ZW654 ┆ 40   │
└───────┴──────┘
</code></pre><h2 id="copy-row-sums-rowsums-of-columns-a-and-b-into-column-a">Copy row-sums (<code>rowSums</code>) of columns &ldquo;a&rdquo; and &ldquo;b&rdquo; into column &ldquo;a&rdquo;<a hidden class="anchor" aria-hidden="true" href="#copy-row-sums-rowsums-of-columns-a-and-b-into-column-a">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;a&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;b&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compute the row-wise sum of columns &#34;a&#34; and &#34;b&#34; and store it in column &#34;a&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    (pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;a&#34;</span>) <span style="color:#f92672">+</span> pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;b&#34;</span>))<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;a&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 2)
┌─────┬─────┐
│ a   ┆ b   │
│ --- ┆ --- │
│ i64 ┆ i64 │
╞═════╪═════╡
│ 5   ┆ 4   │
│ 7   ┆ 5   │
│ 9   ┆ 6   │
└─────┴─────┘
</code></pre><h2 id="drop-columns-with-the-column-name-ending-with-a-pattern">Drop columns with the column name ending with a pattern<a hidden class="anchor" aria-hidden="true" href="#drop-columns-with-the-column-name-ending-with-a-pattern">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2_right&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col4_right&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Drop columns that end with &#34;_right&#34;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>select([col <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> col<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#34;_right&#34;</span>)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 1    ┆ 7    │
│ 2    ┆ 8    │
│ 3    ┆ 9    │
└──────┴──────┘
</code></pre><h2 id="rename-columns-with-the-column-name-ending-with-a-pattern">Rename columns with the column name ending with a pattern<a hidden class="anchor" aria-hidden="true" href="#rename-columns-with-the-column-name-ending-with-a-pattern">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2_right&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col4_right&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Rename columns ending with &#34;_right&#34; to &#34;d*&#34; (d1, d2, ...)</span>
</span></span><span style="display:flex;"><span>new_names <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> col<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#34;_right&#34;</span>):
</span></span><span style="display:flex;"><span>        new_names[col] <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;d</span><span style="color:#e6db74">{</span>counter<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the renaming</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>rename(new_names)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2_right&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col4_right&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create a dictionary to hold the renaming mappings</span>
</span></span><span style="display:flex;"><span>new_names <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Iterate through the columns and rename those ending with &#34;_right&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> col<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#34;_right&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Extract the part before &#34;_right&#34; and prepend &#34;d&#34;</span>
</span></span><span style="display:flex;"><span>        base_name <span style="color:#f92672">=</span> col<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;_right&#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        new_names[col] <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;d</span><span style="color:#e6db74">{</span>base_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the renaming</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>rename(new_names)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 4)
┌──────┬─────┬──────┬─────┐
│ col1 ┆ d1  ┆ col3 ┆ d2  │
│ ---  ┆ --- ┆ ---  ┆ --- │
│ i64  ┆ i64 ┆ i64  ┆ i64 │
╞══════╪═════╪══════╪═════╡
│ 1    ┆ 4   ┆ 7    ┆ 10  │
│ 2    ┆ 5   ┆ 8    ┆ 11  │
│ 3    ┆ 6   ┆ 9    ┆ 12  │
└──────┴─────┴──────┴─────┘
shape: (3, 4)
┌──────┬───────┬──────┬───────┐
│ col1 ┆ dcol2 ┆ col3 ┆ dcol4 │
│ ---  ┆ ---   ┆ ---  ┆ ---   │
│ i64  ┆ i64   ┆ i64  ┆ i64   │
╞══════╪═══════╪══════╪═══════╡
│ 1    ┆ 4     ┆ 7    ┆ 10    │
│ 2    ┆ 5     ┆ 8    ┆ 11    │
│ 3    ┆ 6     ┆ 9    ┆ 12    │
└──────┴───────┴──────┴───────┘
</code></pre><h2 id="rename-columns-based-on-column-index">Rename columns based on column index<a hidden class="anchor" aria-hidden="true" href="#rename-columns-based-on-column-index">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;original1&#34;</span>: [<span style="color:#e6db74">&#34;123-456&#34;</span>, <span style="color:#e6db74">&#34;789-012&#34;</span>, <span style="color:#e6db74">&#34;345-678&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;original2&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;original3&#34;</span>: [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the first two column names</span>
</span></span><span style="display:flex;"><span>old_names <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>columns[:<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># New names for the first two columns</span>
</span></span><span style="display:flex;"><span>new_names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;col1&#34;</span>, <span style="color:#e6db74">&#34;col2&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Rename the first two columns</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>rename({old_names[<span style="color:#ae81ff">0</span>]: new_names[<span style="color:#ae81ff">0</span>], old_names[<span style="color:#ae81ff">1</span>]: new_names[<span style="color:#ae81ff">1</span>]})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 3)
┌─────────┬──────┬───────────┐
│ col1    ┆ col2 ┆ original3 │
│ ---     ┆ ---  ┆ ---       │
│ str     ┆ i64  ┆ i64       │
╞═════════╪══════╪═══════════╡
│ 123-456 ┆ 1    ┆ 10        │
│ 789-012 ┆ 2    ┆ 20        │
│ 345-678 ┆ 3    ┆ 30        │
└─────────┴──────┴───────────┘
</code></pre><h2 id="rename-all-columns-with-a-list">Rename all columns with a list<a hidden class="anchor" aria-hidden="true" href="#rename-all-columns-with-a-list">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;old_name1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;old_name2&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;old_name3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># List of new column names</span>
</span></span><span style="display:flex;"><span>new_column_names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;new_name1&#34;</span>, <span style="color:#e6db74">&#34;new_name2&#34;</span>, <span style="color:#e6db74">&#34;new_name3&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Rename all columns</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>rename({old: new <span style="color:#66d9ef">for</span> old, new <span style="color:#f92672">in</span> zip(df<span style="color:#f92672">.</span>columns, new_column_names)})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 3)
┌───────────┬───────────┬───────────┐
│ new_name1 ┆ new_name2 ┆ new_name3 │
│ ---       ┆ ---       ┆ ---       │
│ i64       ┆ i64       ┆ i64       │
╞═══════════╪═══════════╪═══════════╡
│ 1         ┆ 4         ┆ 7         │
│ 2         ┆ 5         ┆ 8         │
│ 3         ┆ 6         ┆ 9         │
└───────────┴───────────┴───────────┘
</code></pre><h2 id="the-difference-between-strreplace-and-strreplace_all">The difference between <code>.str.replace</code> and <code>.str.replace_all</code><a hidden class="anchor" aria-hidden="true" href="#the-difference-between-strreplace-and-strreplace_all">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;123-456-34&#34;</span>, <span style="color:#e6db74">&#34;789-012-78&#34;</span>, <span style="color:#e6db74">&#34;345-678-02&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col1&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;123-456&#34;</span>, <span style="color:#e6db74">&#34;789-012&#34;</span>, <span style="color:#e6db74">&#34;345-678&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace &#34;-&#34; with &#34;&#34; in the &#34;col1&#34; column</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace_all(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;col1&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 2)
┌───────────┬──────┐
│ col1      ┆ col2 │
│ ---       ┆ ---  │
│ str       ┆ i64  │
╞═══════════╪══════╡
│ 123456-34 ┆ 1    │
│ 789012-78 ┆ 2    │
│ 345678-02 ┆ 3    │
└───────────┴──────┘
shape: (3, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ 123456 ┆ 1    │
│ 789012 ┆ 2    │
│ 345678 ┆ 3    │
└────────┴──────┘
</code></pre><h2 id="read-specific-columns-from-a-csv-file">Read specific columns from a CSV file<a hidden class="anchor" aria-hidden="true" href="#read-specific-columns-from-a-csv-file">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># df = pl.read_csv(&#34;data.csv&#34;, columns=[0, 2])</span>
</span></span></code></pre></div><h2 id="replace-null-with-0-in-the-last-two-columns">Replace null with 0 in the last two columns<a hidden class="anchor" aria-hidden="true" href="#replace-null-with-0-in-the-last-two-columns">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">5</span>, <span style="color:#66d9ef">None</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">9</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace null with 0 in the last two columns</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    [pl<span style="color:#f92672">.</span>col(df<span style="color:#f92672">.</span>columns[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:])<span style="color:#f92672">.</span>fill_null(<span style="color:#ae81ff">0</span>)]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 3)
┌──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 │
│ ---  ┆ ---  ┆ ---  │
│ i64  ┆ i64  ┆ i64  │
╞══════╪══════╪══════╡
│ 1    ┆ 0    ┆ 7    │
│ 2    ┆ 5    ┆ 0    │
│ 3    ┆ 0    ┆ 9    │
└──────┴──────┴──────┘
</code></pre><h2 id="drop-the-first-two-characters-from-all-elements-in-a-dataframe">Drop the first two characters from all elements in a DataFrame<a hidden class="anchor" aria-hidden="true" href="#drop-the-first-two-characters-from-all-elements-in-a-dataframe">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;ab123&#34;</span>, <span style="color:#e6db74">&#34;ab456&#34;</span>, <span style="color:#e6db74">&#34;ab789&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#e6db74">&#34;cd001&#34;</span>, <span style="color:#e6db74">&#34;cd002&#34;</span>, <span style="color:#e6db74">&#34;cd003&#34;</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Drop the first two characters from all elements in the DataFrame</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    [pl<span style="color:#f92672">.</span>col(c)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Now, do the same, but turn the resulting elements into integers.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;ab123&#34;</span>, <span style="color:#e6db74">&#34;ab456&#34;</span>, <span style="color:#e6db74">&#34;ab789&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#e6db74">&#34;cd001&#34;</span>, <span style="color:#e6db74">&#34;cd002&#34;</span>, <span style="color:#e6db74">&#34;cd003&#34;</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Drop the first two characters and convert the remaining strings to integers</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    [pl<span style="color:#f92672">.</span>col(c)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>slice(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>cast(pl<span style="color:#f92672">.</span>Int64) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ str  │
╞══════╪══════╡
│ 123  ┆ 001  │
│ 456  ┆ 002  │
│ 789  ┆ 003  │
└──────┴──────┘
shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 123  ┆ 1    │
│ 456  ┆ 2    │
│ 789  ┆ 3    │
└──────┴──────┘
</code></pre><h2 id="drop-a-column-by-its-index-number">Drop a column by its index number<a hidden class="anchor" aria-hidden="true" href="#drop-a-column-by-its-index-number">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Drop the first column by its index (0)</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>drop(df<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 2)
┌──────┬──────┐
│ col2 ┆ col3 │
│ ---  ┆ ---  │
│ i64  ┆ i64  │
╞══════╪══════╡
│ 4    ┆ 7    │
│ 5    ┆ 8    │
│ 6    ┆ 9    │
└──────┴──────┘
</code></pre><h2 id="reorder-columns">Reorder columns<a hidden class="anchor" aria-hidden="true" href="#reorder-columns">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>select([<span style="color:#e6db74">&#39;col3&#39;</span>, <span style="color:#e6db74">&#39;col2&#39;</span>])
</span></span></code></pre></div><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 2)</small><table border="1" class="dataframe"><thead><tr><th>col3</th><th>col2</th></tr><tr><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>7</td><td>4</td></tr><tr><td>8</td><td>5</td></tr><tr><td>9</td><td>6</td></tr></tbody></table></div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>select([pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#39;col3&#39;</span>), pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#39;col2&#39;</span>)])
</span></span></code></pre></div><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 2)</small><table border="1" class="dataframe"><thead><tr><th>col3</th><th>col2</th></tr><tr><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>7</td><td>4</td></tr><tr><td>8</td><td>5</td></tr><tr><td>9</td><td>6</td></tr></tbody></table></div>
<h2 id="reorder-dataframes-rows-by-matching-a-column-with-a-list">Reorder DataFrame&rsquo;s rows by matching a column with a list<a hidden class="anchor" aria-hidden="true" href="#reorder-dataframes-rows-by-matching-a-column-with-a-list">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;e&#34;</span>, <span style="color:#e6db74">&#34;d&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The desired order for &#34;col1&#34;</span>
</span></span><span style="display:flex;"><span>desired_order <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#e6db74">&#34;e&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reorder the DataFrame by matching &#34;col1&#34; with the desired_order list</span>
</span></span><span style="display:flex;"><span>df_reordered <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(
</span></span><span style="display:flex;"><span>    pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>map_elements(<span style="color:#66d9ef">lambda</span> x: desired_order<span style="color:#f92672">.</span>index(x), return_dtype<span style="color:#f92672">=</span>pl<span style="color:#f92672">.</span>Int64)<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;sort_key&#34;</span>)
</span></span><span style="display:flex;"><span>)<span style="color:#f92672">.</span>sort(<span style="color:#e6db74">&#34;sort_key&#34;</span>)<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#34;sort_key&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df_reordered)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># or</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_reordered <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>join(pl<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#34;col1&#34;</span>: desired_order}), on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;col1&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df_reordered)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
shape: (5, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ i64  │
╞══════╪══════╡
│ a    ┆ 3    │
│ b    ┆ 1    │
│ c    ┆ 2    │
│ d    ┆ 5    │
│ e    ┆ 4    │
└──────┴──────┘
</code></pre><h2 id="filter-the-dataframe-for-elements-containing-a-pattern-in-a-column">Filter the DataFrame for elements containing a pattern in a column<a hidden class="anchor" aria-hidden="true" href="#filter-the-dataframe-for-elements-containing-a-pattern-in-a-column">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#e6db74">&#34;abc123&#34;</span>, <span style="color:#e6db74">&#34;def456&#34;</span>, <span style="color:#e6db74">&#34;ghi789&#34;</span>, <span style="color:#e6db74">&#34;abcxyz&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Filter rows where &#34;col1&#34; contains the pattern &#34;abc&#34;</span>
</span></span><span style="display:flex;"><span>filtered_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>filter(pl<span style="color:#f92672">.</span>col(<span style="color:#e6db74">&#34;col1&#34;</span>)<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>contains(<span style="color:#e6db74">&#34;abc&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(filtered_df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (2, 2)
┌────────┬──────┐
│ col1   ┆ col2 │
│ ---    ┆ ---  │
│ str    ┆ i64  │
╞════════╪══════╡
│ abc123 ┆ 1    │
│ abcxyz ┆ 4    │
└────────┴──────┘
</code></pre><h2 id="compute-the-dotinner-product-crossproduct-between-two-series">Compute the dot/inner product (crossproduct) between two Series<a hidden class="anchor" aria-hidden="true" href="#compute-the-dotinner-product-crossproduct-between-two-series">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>s <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>Series(<span style="color:#e6db74">&#34;a&#34;</span>, [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>s2 <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>Series(<span style="color:#e6db74">&#34;b&#34;</span>, [<span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">5.0</span>, <span style="color:#ae81ff">6.0</span>])
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>dot(s2)
</span></span></code></pre></div><pre tabindex="0"><code>32.0
</code></pre><h2 id="extract-rows-of-a-dataframe-in-a-list-of-tuples">Extract rows of a DataFrame in a list of tuples<a hidden class="anchor" aria-hidden="true" href="#extract-rows-of-a-dataframe-in-a-list-of-tuples">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>rows())
</span></span></code></pre></div><pre tabindex="0"><code>[(&#39;abc123&#39;, 1), (&#39;def456&#39;, 2), (&#39;ghi789&#39;, 3), (&#39;abcxyz&#39;, 4)]
</code></pre><h2 id="get-rowsums-of-a-dataframe">Get <code>rowSums</code> of a DataFrame<a hidden class="anchor" aria-hidden="true" href="#get-rowsums-of-a-dataframe">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>with_columns(df<span style="color:#f92672">.</span>select(pl<span style="color:#f92672">.</span>sum_horizontal(<span style="color:#e6db74">&#34;*&#34;</span>)<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;row_sum&#34;</span>)))
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>with_columns(df<span style="color:#f92672">.</span>select(pl<span style="color:#f92672">.</span>sum_horizontal([<span style="color:#e6db74">&#34;col1&#34;</span>,<span style="color:#e6db74">&#34;col2&#34;</span>])<span style="color:#f92672">.</span>alias(<span style="color:#e6db74">&#34;row_sum&#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(df)
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
</code></pre><h2 id="head-and-tail">head and tail<a hidden class="anchor" aria-hidden="true" href="#head-and-tail">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>tail())
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>tail(<span style="color:#ae81ff">2</span>))
</span></span></code></pre></div><pre tabindex="0"><code>shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
└──────┴──────┴──────┴─────────┘
shape: (3, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 1    ┆ 4    ┆ 7    ┆ 12      │
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
shape: (2, 4)
┌──────┬──────┬──────┬─────────┐
│ col1 ┆ col2 ┆ col3 ┆ row_sum │
│ ---  ┆ ---  ┆ ---  ┆ ---     │
│ i64  ┆ i64  ┆ i64  ┆ i64     │
╞══════╪══════╪══════╪═════════╡
│ 2    ┆ 5    ┆ 8    ┆ 15      │
│ 3    ┆ 6    ┆ 9    ┆ 18      │
└──────┴──────┴──────┴─────────┘
</code></pre><h2 id="matrix-vector-multiplication">Matrix-vector multiplication<a hidden class="anchor" aria-hidden="true" href="#matrix-vector-multiplication">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> pl<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col1&#34;</span>: [<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col2&#34;</span>: [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;col3&#34;</span>: [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(a<span style="color:#f92672">.</span>to_numpy()<span style="color:#f92672">.</span>dot(b))
</span></span></code></pre></div><pre tabindex="0"><code>[10  9  8 20]
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://nilforooshan.github.io/blog/tags/python/">Python</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://nilforooshan.github.io/blog/">Mohammad Ali Nilforooshan</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
